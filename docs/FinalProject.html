<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R course book - 8&nbsp; Project final outcome</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./summary.html" rel="next">
<link href="./Chapter6.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./FinalProject.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Project final outcome</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R course book</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Index</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting familiar with R programming</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Hands-on R programming</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Working flows on R programming</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data transformation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data tidying</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exercise 1: Data plotting and transformations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FinalProject.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Project final outcome</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Project final outcome</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><strong>This is the final result of the script written for the project.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################################################################################</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">################################ LOAD LIBRARIES, FILES AND CLEAN THE ENVRIONMENT #############################################</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################################################</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Clean the environment</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the libraries</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ readr     2.1.4
✔ ggplot2   3.4.3     ✔ stringr   1.5.0
✔ lubridate 1.9.2     ✔ tibble    3.2.1
✔ purrr     1.0.2     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################################################################################</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="do">################################ CALCULATE THE RECOVERY #####################################################</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################################################</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>RECOVERY <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"F:/LINKOPING/Manuscripts/Skyline/Skyline/OrbitrapDust.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Isotope Label Type</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Quan"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Replicate Name</span><span class="st">`</span>, <span class="st">`</span><span class="at">Sample Type</span><span class="st">`</span>),</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> Molecule, <span class="co"># name of the new column</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> Area) <span class="co">#name of the values for the new columns</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="do">##########Filter and prepare the standards that we want to compare to, (I named them Std)</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>Std<span class="ot">&lt;-</span>RECOVERY<span class="sc">|&gt;</span>  </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Replicate Name</span><span class="st">`</span>, IS, RS)<span class="sc">|&gt;</span> <span class="co">#Select the columns that we need</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(<span class="st">`</span><span class="at">Replicate Name</span><span class="st">`</span>, <span class="st">"Std"</span>, <span class="at">negate =</span> <span class="cn">FALSE</span>))<span class="sc">|&gt;</span> <span class="co">#Select the standards</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RatioStd =</span> IS <span class="sc">/</span> RS) <span class="sc">|&gt;</span> <span class="co">#Calculate the IS/RS `Normalized Area` for the standards </span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">AverageRatio =</span> <span class="fu">mean</span>(RatioStd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="co">#Calculate the average of the three standards</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="do">##############Calculate the recovery</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>RECOVERY<span class="ot">&lt;-</span>RECOVERY<span class="sc">|&gt;</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( <span class="st">`</span><span class="at">Sample Type</span><span class="st">`</span> <span class="sc">!=</span> <span class="st">"Standard"</span>) <span class="sc">|&gt;</span>  <span class="co">#Filter to remove the standards out of the data frame|&gt;#Exclude the calibration standards</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RatioSample=</span> IS <span class="sc">/</span> RS) <span class="sc">|&gt;</span> <span class="co">#Divide IS/RS for all samples</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Recovery=</span>RatioSample<span class="sc">/</span><span class="fu">as.numeric</span>(Std))<span class="sc">|&gt;</span> <span class="co">#Divide each sample ratio of IS/RS by the average ratio of the standards</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RecoveryPerc=</span>Recovery<span class="sc">*</span><span class="dv">100</span>) <span class="co">#The recovery in percentage</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="do">#################Plotting the recovery</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors based on conditions: less than 50% red and above green</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>RECOVERY<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(RECOVERY<span class="sc">$</span>RecoveryPerc <span class="sc">&gt;</span> <span class="dv">50</span>, <span class="st">"#CD3333"</span>, <span class="st">"#9ACD32"</span>)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="co">#Reorder the samples</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>RECOVERY<span class="sc">$</span><span class="st">`</span><span class="at">Replicate Name</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">factor</span>(RECOVERY<span class="sc">$</span><span class="st">`</span><span class="at">Replicate Name</span><span class="st">`</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"1B"</span>, <span class="st">"1C"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4A"</span>, <span class="st">"4B"</span>, <span class="st">"5A"</span>, <span class="st">"5B"</span>, <span class="st">"6"</span>, <span class="st">"7"</span>, <span class="st">"8"</span>, <span class="st">"9"</span>, <span class="st">"10"</span>, <span class="st">"11"</span>, <span class="st">"12"</span>, <span class="st">"13"</span>, <span class="st">"14"</span>, <span class="st">"15"</span>, <span class="st">"18"</span>, <span class="st">"19"</span>, <span class="st">"20"</span>, <span class="st">"D1"</span>, <span class="st">"D2"</span>, <span class="st">"D3"</span>, <span class="st">"21 Na2SO4"</span>, <span class="st">"23 24 FB"</span>, <span class="st">"25 LB"</span>, <span class="st">"26 LB"</span>, <span class="st">"27 LB"</span>, <span class="st">"28 LB"</span>, <span class="st">"29 MLB"</span>))</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(RECOVERY, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Replicate Name</span><span class="st">`</span>, <span class="at">y =</span> RecoveryPerc, <span class="at">fill =</span> color)) <span class="sc">+</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#CD3333"</span>, <span class="st">"#9ACD32"</span>), <span class="at">guide =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Replicate Name"</span>, <span class="at">y =</span> <span class="st">"RECOVERY"</span>, <span class="at">title =</span> <span class="st">"RECOVERY"</span>) <span class="sc">+</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (`geom_bar()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `guide` argument in `scale_*()` cannot be `FALSE`. This was deprecated in
ggplot2 3.3.4.
ℹ Please use "none" instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################################################################</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="do">##################################### SCCPs##################################################</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################################################################</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################################################################################</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="do">################################ PREPARE THE STANDARDS FOR CALIBRATION #####################################################</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################################################</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="do">########################### STANDARDS A #############################################################</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the file</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>TESTING <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"F:/LINKOPING/Manuscripts/Skyline/Skyline/OrbitrapDust.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span>)) </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values in the Response_factor column with 0</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>TESTING <span class="ot">&lt;-</span> TESTING <span class="sc">|&gt;</span> </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>), <span class="dv">0</span>, <span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>))  <span class="co"># Replace NAs with 0</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create molecule names</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>create_molecule_name <span class="ot">&lt;-</span> <span class="cf">function</span>(i, j) {</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  molecule_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"C"</span>, i, <span class="st">"H"</span>, (<span class="dv">2</span> <span class="sc">*</span> i) <span class="sc">+</span> <span class="dv">2</span> <span class="sc">-</span> j, <span class="st">"Cl"</span>, j)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(molecule_name)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty list to store plots and calibration results</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>plotsA <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>calibration_resultsA <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">STD_code =</span> <span class="fu">character</span>(),</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Reference_standard =</span> <span class="fu">character</span>(),</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Chain_length =</span> <span class="fu">character</span>(),</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Type =</span> <span class="fu">character</span>(),</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Homologue =</span> <span class="fu">character</span>(),</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Response_factor =</span> <span class="fu">numeric</span>(),</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Intercept =</span> <span class="fu">numeric</span>(),</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">R_squared =</span> <span class="fu">numeric</span>(),</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the range of i and j</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>i_values <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">13</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>j_values <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Nested loops to iterate over i and j</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> i_values) {</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> j_values) {</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create molecule name</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    molecule_name <span class="ot">&lt;-</span> <span class="fu">create_molecule_name</span>(i, j)</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter data for the current molecule</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>    filtered_dataA <span class="ot">&lt;-</span> TESTING <span class="sc">|&gt;</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="st">`</span><span class="at">Isotope Label Type</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Quan"</span>, Molecule <span class="sc">==</span> molecule_name, Note <span class="sc">==</span> <span class="st">"A"</span>)<span class="sc">|&gt;</span> </span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C9"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration vSCCPs</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C14"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration MCCPs</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C15"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration MCCPs</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C16"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration MCCPs</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C17"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span><span class="co">#Exclude the calibration MCCPs</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"IS"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> <span class="co">#Exclude the calibration IS</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"IS"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="co">#Exclude the calibration RS </span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if there are any non-NA cases in the filtered data</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(filtered_dataA<span class="sc">$</span><span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>)) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">||</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(filtered_dataA<span class="sc">$</span><span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span>)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"No valid cases for fitting the model for molecule:"</span>, molecule_name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Fit linear model to the data</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>      lm_modelA <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span>, <span class="at">data =</span> filtered_dataA)</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Extract slope and intercept from the model</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>      slopeA <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm_modelA)[<span class="dv">2</span>]</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>      interceptA <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm_modelA)[<span class="dv">1</span>]</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate R-squared</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>      R_squaredA <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_modelA)<span class="sc">$</span>r.squared</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Determine the type based on the value of i</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">&gt;=</span> <span class="dv">10</span> <span class="sc">&amp;&amp;</span> i <span class="sc">&lt;=</span> <span class="dv">13</span>) {</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"SCCPs"</span></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">&gt;=</span> <span class="dv">14</span> <span class="sc">&amp;&amp;</span> i <span class="sc">&lt;=</span> <span class="dv">17</span>) {</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"MCCPs"</span></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;&amp;</span> i <span class="sc">&lt;=</span> <span class="dv">30</span>) {</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"LCCPs"</span></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"Unknown"</span></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Store the calibration results in the data frame, create the columns and values that we need to fit with the next script (the one for the deconvolution paper published by I don't remember)</span></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>      calibration_resultsA <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calibration_resultsA, </span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">data.frame</span>(<span class="at">STD_code =</span> <span class="fu">paste</span>(<span class="st">"A-"</span>, type),</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Reference_standard =</span> <span class="fu">paste</span>(type, <span class="st">"C"</span>, i, <span class="st">"Cl%"</span>, <span class="st">"52"</span>),</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Chain_length =</span> <span class="fu">paste</span>(<span class="st">"C"</span>,i),</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Type =</span> type,</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Homologue =</span> molecule_name,</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Response_factor =</span> <span class="fu">round</span>(slopeA),</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Intercept =</span> interceptA,</span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">R_squared =</span> R_squaredA))</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create plot for the current molecule</span></span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>      plotA <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_dataA, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>                    <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>                    <span class="at">colour =</span> <span class="st">"orange"</span>,</span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">"`Normalized Area`"</span>) <span class="sc">+</span></span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Molecule:"</span>, molecule_name))</span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Store the plot in the list</span></span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>      plotsA[[<span class="fu">paste</span>(<span class="st">"Molecule"</span>, molecule_name)]] <span class="ot">&lt;-</span> plotA</span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>No valid cases for fitting the model for molecule: C10H11Cl11 
No valid cases for fitting the model for molecule: C10H10Cl12 
No valid cases for fitting the model for molecule: C11H12Cl12 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the data frame with calibration results</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(calibration_resultsA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          STD_code Reference_standard Chain_length  Type
`Analyte Concentration`   A- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`1  A- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`2  A- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`3  A- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`4  A- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`5  A- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`6  A- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`7  A- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`8  A- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`9  A- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`10 A- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`11 A- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`12 A- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`13 A- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`14 A- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`15 A- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`16 A- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`17 A- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`18 A- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`19 A- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`20 A- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`21 A- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`22 A- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`23 A- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`24 A- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`25 A- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`26 A- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`27 A- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`28 A- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`29 A- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`30 A- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`31 A- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`32 A- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`33 A- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`34 A- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`35 A- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`36 A- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
                           Homologue Response_factor     Intercept   R_squared
`Analyte Concentration`    C10H19Cl3               0  1.110787e-03 0.094118760
`Analyte Concentration`1   C10H18Cl4               0  7.660396e-04 0.095380911
`Analyte Concentration`2   C10H17Cl5               0 -1.067962e-01 0.972364777
`Analyte Concentration`3   C10H16Cl6               1 -5.805899e-01 0.999100694
`Analyte Concentration`4   C10H15Cl7               1 -6.466615e-01 0.997168436
`Analyte Concentration`5   C10H14Cl8               0 -1.343370e-01 0.957923434
`Analyte Concentration`6   C10H13Cl9               0 -1.397210e-04 0.953905360
`Analyte Concentration`7  C10H12Cl10               0  0.000000e+00         NaN
`Analyte Concentration`8   C11H21Cl3               0  1.041460e-03 0.260890236
`Analyte Concentration`9   C11H20Cl4               0  1.135540e-03 0.534350583
`Analyte Concentration`10  C11H19Cl5               0 -2.950672e-01 0.998807807
`Analyte Concentration`11  C11H18Cl6               9 -3.082314e+00 0.999420229
`Analyte Concentration`12  C11H17Cl7              10 -5.131497e+00 0.998135396
`Analyte Concentration`13  C11H16Cl8               2 -1.245214e+00 0.997649468
`Analyte Concentration`14  C11H15Cl9               0 -1.331697e-01 0.960900241
`Analyte Concentration`15 C11H14Cl10               0  0.000000e+00         NaN
`Analyte Concentration`16 C11H13Cl11               0  0.000000e+00         NaN
`Analyte Concentration`17  C12H23Cl3               0  1.394134e-03 0.341374248
`Analyte Concentration`18  C12H22Cl4               0  9.985583e-04 0.022305640
`Analyte Concentration`19  C12H21Cl5               0 -3.502319e-01 0.997495856
`Analyte Concentration`20  C12H20Cl6              11 -5.720998e+00 0.998307762
`Analyte Concentration`21  C12H19Cl7              17 -8.993276e+00 0.997391653
`Analyte Concentration`22  C12H18Cl8               4 -1.951457e+00 0.998457346
`Analyte Concentration`23  C12H17Cl9               0 -4.275416e-01 0.985910168
`Analyte Concentration`24 C12H16Cl10               0 -3.741886e-04 0.986667151
`Analyte Concentration`25 C12H15Cl11               0  0.000000e+00         NaN
`Analyte Concentration`26 C12H14Cl12               0 -7.609113e-05 0.953905360
`Analyte Concentration`27  C13H25Cl3               0  1.109348e-03 0.093688494
`Analyte Concentration`28  C13H24Cl4               0  1.387559e-03 0.196812360
`Analyte Concentration`29  C13H23Cl5               0 -2.509690e-01 0.987797467
`Analyte Concentration`30  C13H22Cl6               6 -3.838386e+00 0.997264297
`Analyte Concentration`31  C13H21Cl7              11 -5.371234e+00 0.997683538
`Analyte Concentration`32  C13H20Cl8               4 -1.211326e+00 0.999523152
`Analyte Concentration`33  C13H19Cl9               1 -5.664803e-01 0.992488948
`Analyte Concentration`34 C13H18Cl10               0 -4.165114e-03 0.960305380
`Analyte Concentration`35 C13H17Cl11               0  1.530314e-04 0.003231224
`Analyte Concentration`36 C13H16Cl12               0  3.513047e-04 0.052485876</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange plots in a grid</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>calibration_curves_gridA <span class="ot">&lt;-</span> plotsA[[<span class="dv">1</span>]]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(plotsA)) {</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  calibration_curves_gridA <span class="ot">&lt;-</span> calibration_curves_gridA <span class="sc">+</span> plotsA[[i]]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the grid of calibration curves</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>calibration_curves_gridA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">########################### STANDARDS B #####################################################################################</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values in the Response_factor column with 0</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>TESTING <span class="ot">&lt;-</span> TESTING <span class="sc">|&gt;</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">replace_na</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>, <span class="dv">0</span>)) </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create molecule names</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>create_molecule_name <span class="ot">&lt;-</span> <span class="cf">function</span>(i, j) {</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  molecule_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"C"</span>, i, <span class="st">"H"</span>, (<span class="dv">2</span> <span class="sc">*</span> i) <span class="sc">+</span> <span class="dv">2</span> <span class="sc">-</span> j, <span class="st">"Cl"</span>, j)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(molecule_name)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty list to store plots and calibration results</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>plotsB <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>calibration_resultsB <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">STD_code =</span> <span class="fu">character</span>(),</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Reference_standard =</span> <span class="fu">character</span>(),</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Chain_length =</span> <span class="fu">character</span>(),</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Type =</span> <span class="fu">character</span>(),</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Homologue =</span> <span class="fu">character</span>(),</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Response_factor =</span> <span class="fu">numeric</span>(),</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Intercept =</span> <span class="fu">numeric</span>(),</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">R_squared =</span> <span class="fu">numeric</span>(),</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the range of i and j</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>i_values <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">13</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>j_values <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Nested loops to iterate over i and j</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> i_values) {</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> j_values) {</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create molecule name</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    molecule_name <span class="ot">&lt;-</span> <span class="fu">create_molecule_name</span>(i, j)</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter data for the current molecule</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    filtered_dataB <span class="ot">&lt;-</span> TESTING <span class="sc">|&gt;</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="st">`</span><span class="at">Isotope Label Type</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Quan"</span>, Molecule <span class="sc">==</span> molecule_name, Note <span class="sc">==</span> <span class="st">"B"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C9"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration vSCCPs</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C14"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration MCCPs</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C15"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration MCCPs</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C16"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration MCCPs</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C17"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration MCCPs</span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"IS"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> <span class="co">#Exclude the calibration IS</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"IS"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="co">#Exclude the calibration RS</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if there are any non-NA cases in the filtered data</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(filtered_dataB<span class="sc">$</span><span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>)) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">||</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(filtered_dataB<span class="sc">$</span><span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span>)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"No valid cases for fitting the model for molecule:"</span>, molecule_name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Fit linear model to the data</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>      lm_modelB <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span>, <span class="at">data =</span> filtered_dataB)</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Extract slope and intercept from the model</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>      slopeB <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm_modelB)[<span class="dv">2</span>]</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>      interceptB <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm_modelB)[<span class="dv">1</span>]</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate R-squared</span></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>      R_squaredB <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_modelB)<span class="sc">$</span>r.squared</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Determine the type based on the value of i</span></span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">&gt;=</span> <span class="dv">10</span> <span class="sc">&amp;&amp;</span> i <span class="sc">&lt;=</span> <span class="dv">13</span>) {</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"SCCPs"</span></span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">&gt;=</span> <span class="dv">14</span> <span class="sc">&amp;&amp;</span> i <span class="sc">&lt;=</span> <span class="dv">17</span>) {</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"MCCPs"</span></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;&amp;</span> i <span class="sc">&lt;=</span> <span class="dv">30</span>) {</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"LCCPs"</span></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"Unknown"</span></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Store the calibration results in the data frame, create the columns and values that we need to fit with the next script (the one for the deconvolution paper published by I don't remember)</span></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>      calibration_resultsB <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calibration_resultsB, </span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">data.frame</span>(<span class="at">STD_code =</span> <span class="fu">paste</span>(<span class="st">"B-"</span>, type),</span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Reference_standard =</span> <span class="fu">paste</span>(type, <span class="st">"C"</span>, i, <span class="st">"Cl%"</span>, <span class="st">"52"</span>),</span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Chain_length =</span> <span class="fu">paste</span>(<span class="st">"C"</span>,i),</span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Type =</span> type,</span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Homologue =</span> molecule_name,</span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Response_factor =</span> <span class="fu">round</span>(slopeB),</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Intercept =</span> interceptB,</span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">R_squared =</span> R_squaredB))</span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create plot for the current molecule</span></span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>      plotB <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_dataB, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>                    <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a>                    <span class="at">colour =</span> <span class="st">"purple"</span>,</span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">"`Normalized Area`"</span>) <span class="sc">+</span></span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Molecule:"</span>, molecule_name))</span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Store the plot in the list</span></span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>      plotsB[[<span class="fu">paste</span>(<span class="st">"Molecule"</span>, molecule_name)]] <span class="ot">&lt;-</span> plotB</span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>No valid cases for fitting the model for molecule: C10H11Cl11 
No valid cases for fitting the model for molecule: C10H10Cl12 
No valid cases for fitting the model for molecule: C11H12Cl12 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the data frame with calibration results</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(calibration_resultsB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          STD_code Reference_standard Chain_length  Type
`Analyte Concentration`   B- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`1  B- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`2  B- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`3  B- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`4  B- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`5  B- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`6  B- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`7  B- SCCPs  SCCPs C 10 Cl% 52         C 10 SCCPs
`Analyte Concentration`8  B- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`9  B- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`10 B- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`11 B- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`12 B- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`13 B- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`14 B- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`15 B- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`16 B- SCCPs  SCCPs C 11 Cl% 52         C 11 SCCPs
`Analyte Concentration`17 B- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`18 B- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`19 B- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`20 B- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`21 B- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`22 B- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`23 B- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`24 B- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`25 B- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`26 B- SCCPs  SCCPs C 12 Cl% 52         C 12 SCCPs
`Analyte Concentration`27 B- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`28 B- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`29 B- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`30 B- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`31 B- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`32 B- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`33 B- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`34 B- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`35 B- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
`Analyte Concentration`36 B- SCCPs  SCCPs C 13 Cl% 52         C 13 SCCPs
                           Homologue Response_factor     Intercept  R_squared
`Analyte Concentration`    C10H19Cl3               0  1.622994e-03 0.54109171
`Analyte Concentration`1   C10H18Cl4               0  1.050903e-03 0.01098121
`Analyte Concentration`2   C10H17Cl5               0 -1.115449e-01 0.97368002
`Analyte Concentration`3   C10H16Cl6               2 -6.842041e-01 0.99938266
`Analyte Concentration`4   C10H15Cl7               4 -1.584414e+00 0.99781163
`Analyte Concentration`5   C10H14Cl8               1 -9.333744e-01 0.99608993
`Analyte Concentration`6   C10H13Cl9               0 -1.569428e-01 0.96442999
`Analyte Concentration`7  C10H12Cl10               0 -2.590504e-04 0.98405375
`Analyte Concentration`8   C11H21Cl3               0  1.275335e-03 0.13611096
`Analyte Concentration`9   C11H20Cl4               0  9.144824e-04 0.01996688
`Analyte Concentration`10  C11H19Cl5               0 -2.665128e-01 0.99760793
`Analyte Concentration`11  C11H18Cl6              14 -4.343758e+00 0.99747351
`Analyte Concentration`12  C11H17Cl7              36 -1.722425e+01 0.99560511
`Analyte Concentration`13  C11H16Cl8              15 -8.662715e+00 0.99476500
`Analyte Concentration`14  C11H15Cl9               2 -1.411540e+00 0.99659845
`Analyte Concentration`15 C11H14Cl10               0 -2.650630e-01 0.96842984
`Analyte Concentration`16 C11H13Cl11               0 -5.374623e-03 0.96332918
`Analyte Concentration`17  C12H23Cl3               0  1.076907e-03 0.03573810
`Analyte Concentration`18  C12H22Cl4               0  7.594077e-04 0.04575944
`Analyte Concentration`19  C12H21Cl5               0 -2.458860e-01 0.98982356
`Analyte Concentration`20  C12H20Cl6              13 -6.627449e+00 0.99551164
`Analyte Concentration`21  C12H19Cl7              46 -2.716163e+01 0.99375224
`Analyte Concentration`22  C12H18Cl8              25 -1.418757e+01 0.99432333
`Analyte Concentration`23  C12H17Cl9               5 -2.308360e+00 0.99706652
`Analyte Concentration`24 C12H16Cl10               0 -5.276869e-01 0.98807249
`Analyte Concentration`25 C12H15Cl11               0 -1.841006e-02 0.96184243
`Analyte Concentration`26 C12H14Cl12               0  0.000000e+00        NaN
`Analyte Concentration`27  C13H25Cl3               0  1.063636e-03 0.18660246
`Analyte Concentration`28  C13H24Cl4               0  8.719725e-04 0.02938617
`Analyte Concentration`29  C13H23Cl5               0 -8.680935e-02 0.96260489
`Analyte Concentration`30  C13H22Cl6               6 -3.909525e+00 0.99339981
`Analyte Concentration`31  C13H21Cl7              24 -1.549797e+01 0.99275692
`Analyte Concentration`32  C13H20Cl8              18 -8.553864e+00 0.99522471
`Analyte Concentration`33  C13H19Cl9               5 -1.660535e+00 0.99842720
`Analyte Concentration`34 C13H18Cl10               1 -6.656747e-01 0.99250970
`Analyte Concentration`35 C13H17Cl11               0 -2.017983e-02 0.96001617
`Analyte Concentration`36 C13H16Cl12               0  2.841305e-04 0.04535875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange plots in a grid</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>calibration_curves_gridB <span class="ot">&lt;-</span> plotsB[[<span class="dv">1</span>]]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(plotsB)) {</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  calibration_curves_gridB <span class="ot">&lt;-</span> calibration_curves_gridB <span class="sc">+</span> plotsB[[i]]</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the grid of calibration curves</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>calibration_curves_gridB</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-1-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">########################### COMBINE STNADARDS A AND B ######################################################################</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calibration_resultsA, calibration_resultsB)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################################################################################</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="do">################################ PREPARE THE SAMPLES FOR CALIBRATION #####################################################</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################################################</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>TESTINGB <span class="ot">&lt;-</span> TESTING <span class="sc">|&gt;</span> </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Isotope Label Type</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Quan"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>),</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Chain_length =</span> <span class="fu">paste</span>(<span class="st">"C"</span>, <span class="fu">sub</span>(<span class="st">".*-C(9|10|11|12|13|14|15|16|17)$"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, <span class="st">`</span><span class="at">Molecule List</span><span class="st">`</span>)), <span class="co">#Create the columns that contains the chain length as for example C10 or C11 or C12 etc.</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">ifelse</span>(</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>      Chain_length <span class="sc">&gt;=</span> <span class="dv">10</span> <span class="sc">&amp;</span> Chain_length <span class="sc">&lt;=</span> <span class="dv">13</span>, <span class="st">"SCCPs"</span>,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>        Chain_length <span class="sc">&gt;=</span> <span class="dv">14</span> <span class="sc">&amp;</span> Chain_length <span class="sc">&lt;=</span> <span class="dv">17</span>, <span class="st">"MCCPs"</span>,</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ifelse</span>(Chain_length <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span> Chain_length <span class="sc">&lt;=</span> <span class="dv">30</span>, <span class="st">"LCCPs"</span>, <span class="st">"Unknown"</span>) <span class="co">#Create the column type which should contain SCCPs, MCCPs and LCCPs depending on the chain length</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Homologue =</span> Molecule) <span class="sc">|&gt;</span> </span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( <span class="st">`</span><span class="at">Sample Type</span><span class="st">`</span> <span class="sc">!=</span> <span class="st">"Standard"</span> <span class="co">#Filter to remove the standards out of the data frame</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Homologue, <span class="st">"C9"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration vSCCPs</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Homologue, <span class="st">"C14"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration MCCPs</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Homologue, <span class="st">"C15"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration MCCPs</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Homologue, <span class="st">"C16"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration MCCPs</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Homologue, <span class="st">"C17"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration MCCPs</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Homologue, <span class="st">"IS"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> <span class="co">#Exclude the calibration IS</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Homologue, <span class="st">"RS"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span>  <span class="co">#Exclude the calibration RS</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(<span class="st">`</span><span class="at">Replicate Name</span><span class="st">`</span>, <span class="st">"Std"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="co">#Exclude the calibration standards</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `Normalized Area = as.numeric(`Normalized Area`)`.
Caused by warning:
! NAs introduced by coercion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group samples for creating one data frame for each: the CALIBRATION script requires to have one data frame for each sample, so out of the current data frame we should create a new of for each of the samples</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>list_of_samples <span class="ot">&lt;-</span> <span class="fu">split</span>(TESTINGB, TESTINGB<span class="sc">$</span><span class="st">`</span><span class="at">Replicate Name</span><span class="st">`</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################################################################################</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="do">########################################## CALIBRATION #####################################################</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################################################</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="do">#####GROUP STANDARD MIXTURES USED#####</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="do">#####Set working directory#####</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>working.directory <span class="ot">&lt;-</span> <span class="st">"F:/LINKOPING/Manuscripts/Skyline/Skyline/"</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################PREPARE DATASET FOR PATTERN RECONSTRUCTION#################</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rename the file of the standards that we have created previous for calibration so it will fit the script</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  input <span class="ot">&lt;-</span> combined_df</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  input<span class="sc">$</span>STD_code <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(input<span class="sc">$</span>STD_code)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create all possible binary combinations between given calibration sets</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  Combinations <span class="ot">&lt;-</span> <span class="fu">combn</span>(<span class="at">x =</span> <span class="fu">levels</span>(input<span class="sc">$</span>STD_code), <span class="at">m =</span> <span class="dv">2</span>, <span class="at">FUN =</span> <span class="cn">NULL</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store sum RFs for each group CP standard</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  input <span class="ot">&lt;-</span> input <span class="sc">|&gt;</span> </span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Reference_standard) <span class="sc">|&gt;</span> </span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Sum_response_factor =</span> <span class="fu">sum</span>(Response_factor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>  input[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(input[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], as.factor)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>  input<span class="sc">$</span>Response_factor[<span class="fu">is.na</span>(input<span class="sc">$</span>Response_factor)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a><span class="do">############################################SECTION FOR SAMPLE PROCESSING##########################</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="do">## The script was made for quantifying one sample at the time, so I changed it to iterate for all the data frames of the samples</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty list to store results for all samples</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>all_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>all_plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract unique sample names, it will give the to each "data frame"</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>unique_sample_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(TESTINGB<span class="sc">$</span><span class="st">`</span><span class="at">Replicate Name</span><span class="st">`</span>)</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over each unique sample name</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sample_name <span class="cf">in</span> unique_sample_names) {</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the corresponding sample data frame, now I will use sample_df for further procesing</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>  sample_df <span class="ot">&lt;-</span> list_of_samples[[sample_name]]</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set sample name, to see which samples it will calibrate</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Processing sample:"</span>, sample_name))</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>  <span class="do">####################################RUN PATTERN RECONSTRUCTION FOR SELECTED (LOADED) SAMPLE####################</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">#This section is mostly how it was given, I only included the info to fill in the empty list that I created at the begging so I will get the results for each sample. I also combined all results into one data frame so I would not have one data frame for ach sample. </span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>  sample_df <span class="ot">&lt;-</span> sample_df <span class="sc">|&gt;</span> </span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">Chain_length =</span> <span class="fu">as.factor</span>(Chain_length),</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>),</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">Relative_distribution =</span> <span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate relative `Normalized Area` distribution within each homologue group</span></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>  sample_df<span class="sc">$</span>Relative_distribution <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>  sample_df<span class="sc">$</span><span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>[<span class="fu">is.na</span>(sample_df<span class="sc">$</span><span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>  sample_df <span class="ot">&lt;-</span> sample_df <span class="sc">|&gt;</span>  <span class="fu">mutate</span>(<span class="at">Relative_distribution =</span> <span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> sample_df</span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>  results[<span class="fu">c</span>(<span class="st">"Comp_1"</span>, <span class="st">"Comp_2"</span>, <span class="st">"Fraction_Comp_1"</span>, <span class="st">"Simulated_pattern"</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Deconvolution of homologue patterns (adjust your loop accordingly)</span></span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>  REF <span class="ot">&lt;-</span> sample_df<span class="sc">$</span>Relative_distribution</span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>  Distance <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (z <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Combinations[<span class="dv">1</span>,])) {</span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>    C_1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(input, <span class="at">subset =</span> (STD_code <span class="sc">==</span> Combinations[<span class="dv">1</span>, z]))</span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>    C_2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(input, <span class="at">subset =</span> (STD_code <span class="sc">==</span> Combinations[<span class="dv">2</span>, z]))</span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a>      Combo <span class="ot">&lt;-</span> (C_1<span class="sc">$</span>Response_factor <span class="sc">*</span> j <span class="sc">+</span> C_2<span class="sc">$</span>Response_factor <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">-</span> j)) <span class="sc">/</span> <span class="fu">sum</span>((C_1<span class="sc">$</span>Response_factor <span class="sc">*</span> j <span class="sc">+</span> C_2<span class="sc">$</span>Response_factor <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">-</span> j)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check for NA values in REF or Combo before comparison</span></span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">any</span>(<span class="fu">is.na</span>(REF)) <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">any</span>(<span class="fu">is.na</span>(Combo)) <span class="sc">&amp;&amp;</span> Distance <span class="sc">&gt;</span> (<span class="fu">sum</span>(<span class="fu">sqrt</span>((REF <span class="sc">-</span> Combo)<span class="sc">^</span><span class="dv">2</span>)))) {</span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a>        results<span class="sc">$</span>Comp_1 <span class="ot">&lt;-</span> <span class="fu">as.character</span>(C_1<span class="sc">$</span>STD_code)</span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a>        results<span class="sc">$</span>Comp_2 <span class="ot">&lt;-</span> <span class="fu">as.character</span>(C_2<span class="sc">$</span>STD_code)</span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a>        results<span class="sc">$</span>Fraction_Comp_1 <span class="ot">&lt;-</span> j</span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a>        results<span class="sc">$</span>Simulated_pattern <span class="ot">&lt;-</span> Combo</span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a>        Distance <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sqrt</span>((REF <span class="sc">-</span> Combo)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate concentrations (ng per microliter)</span></span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a>  results<span class="sc">$</span>RF_1st <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a>  results<span class="sc">$</span>RF_2nd <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb26-95"><a href="#cb26-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-96"><a href="#cb26-96" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(results)) {</span>
<span id="cb26-97"><a href="#cb26-97" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>RF_1st[i] <span class="ot">&lt;-</span> input<span class="sc">$</span>Sum_response_factor[input<span class="sc">$</span>STD_code <span class="sc">==</span> results<span class="sc">$</span>Comp_1[i]]</span>
<span id="cb26-98"><a href="#cb26-98" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>RF_2nd[i] <span class="ot">&lt;-</span> input<span class="sc">$</span>Sum_response_factor[input<span class="sc">$</span>STD_code <span class="sc">==</span> results<span class="sc">$</span>Comp_2[i]]</span>
<span id="cb26-99"><a href="#cb26-99" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-100"><a href="#cb26-100" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-101"><a href="#cb26-101" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> results <span class="sc">|&gt;</span> </span>
<span id="cb26-102"><a href="#cb26-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-103"><a href="#cb26-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">RF_1st =</span> <span class="fu">as.numeric</span>(RF_1st),</span>
<span id="cb26-104"><a href="#cb26-104" aria-hidden="true" tabindex="-1"></a>      <span class="at">RF_2nd =</span> <span class="fu">as.numeric</span>(RF_2nd),</span>
<span id="cb26-105"><a href="#cb26-105" aria-hidden="true" tabindex="-1"></a>      <span class="at">Concentration =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>) <span class="sc">/</span> (RF_1st <span class="sc">*</span> (Fraction_Comp_1 <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">+</span> RF_2nd <span class="sc">*</span> ((<span class="dv">100</span> <span class="sc">-</span> Fraction_Comp_1) <span class="sc">/</span> <span class="dv">100</span>))</span>
<span id="cb26-106"><a href="#cb26-106" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-107"><a href="#cb26-107" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-108"><a href="#cb26-108" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the results for the current sample in the list</span></span>
<span id="cb26-109"><a href="#cb26-109" aria-hidden="true" tabindex="-1"></a>  all_results[[sample_name]] <span class="ot">&lt;-</span> results</span>
<span id="cb26-110"><a href="#cb26-110" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-111"><a href="#cb26-111" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Visualization of results</span></span>
<span id="cb26-112"><a href="#cb26-112" aria-hidden="true" tabindex="-1"></a>  plot_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-113"><a href="#cb26-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">Distribution =</span> <span class="fu">c</span>(results<span class="sc">$</span>Relative_distribution, results<span class="sc">$</span>Simulated_pattern),</span>
<span id="cb26-114"><a href="#cb26-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">Homologue =</span> results<span class="sc">$</span>Homologue,</span>
<span id="cb26-115"><a href="#cb26-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">Chain_length =</span> results<span class="sc">$</span>Chain_length,</span>
<span id="cb26-116"><a href="#cb26-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">Origin =</span> <span class="fu">rep</span>(<span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">"Measured"</span>, <span class="st">"Simulated"</span>)), <span class="at">each =</span> <span class="fu">nrow</span>(results))</span>
<span id="cb26-117"><a href="#cb26-117" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-118"><a href="#cb26-118" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-119"><a href="#cb26-119" aria-hidden="true" tabindex="-1"></a>  plot_table<span class="sc">$</span>Homologue <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_table<span class="sc">$</span>Homologue, <span class="at">levels =</span> <span class="fu">unique</span>(plot_table<span class="sc">$</span>Homologue))</span>
<span id="cb26-120"><a href="#cb26-120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-121"><a href="#cb26-121" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_table, <span class="fu">aes</span>(<span class="at">x =</span> Homologue, <span class="at">y =</span> Distribution <span class="sc">*</span> <span class="dv">100</span>, <span class="at">fill =</span> Origin, <span class="at">colour =</span> Origin)) <span class="sc">+</span></span>
<span id="cb26-122"><a href="#cb26-122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">width =</span> <span class="fl">0.8</span>, <span class="at">size =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb26-123"><a href="#cb26-123" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb26-124"><a href="#cb26-124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkolivegreen3"</span>, <span class="st">"darkslategray4"</span>)) <span class="sc">+</span></span>
<span id="cb26-125"><a href="#cb26-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkolivegreen4"</span>, <span class="st">"darkslategray"</span>)) <span class="sc">+</span></span>
<span id="cb26-126"><a href="#cb26-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="fu">paste</span>(sample_name, <span class="st">" - Distribution of CP homologues"</span>)) <span class="sc">+</span></span>
<span id="cb26-127"><a href="#cb26-127" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb26-128"><a href="#cb26-128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Relative `Normalized Area` distribution, %"</span>) <span class="sc">+</span></span>
<span id="cb26-129"><a href="#cb26-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb26-130"><a href="#cb26-130" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb26-131"><a href="#cb26-131" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"in"</span>),</span>
<span id="cb26-132"><a href="#cb26-132" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb26-133"><a href="#cb26-133" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb26-134"><a href="#cb26-134" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb26-135"><a href="#cb26-135" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">colour =</span> <span class="st">"grey20"</span>),</span>
<span id="cb26-136"><a href="#cb26-136" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey50"</span>),</span>
<span id="cb26-137"><a href="#cb26-137" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey80"</span>),</span>
<span id="cb26-138"><a href="#cb26-138" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-139"><a href="#cb26-139" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb26-140"><a href="#cb26-140" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey20"</span>),</span>
<span id="cb26-141"><a href="#cb26-141" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb26-142"><a href="#cb26-142" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb26-143"><a href="#cb26-143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(. <span class="sc">~</span> Chain_length, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb26-144"><a href="#cb26-144" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-145"><a href="#cb26-145" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the plot for the current sample in the list</span></span>
<span id="cb26-146"><a href="#cb26-146" aria-hidden="true" tabindex="-1"></a>  all_plots[[sample_name]] <span class="ot">&lt;-</span> plot</span>
<span id="cb26-147"><a href="#cb26-147" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-148"><a href="#cb26-148" aria-hidden="true" tabindex="-1"></a>  results_output_SCCPs <span class="ot">&lt;-</span> results <span class="sc">|&gt;</span> </span>
<span id="cb26-149"><a href="#cb26-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">median</span>(Concentration)) <span class="sc">|&gt;</span> </span>
<span id="cb26-150"><a href="#cb26-150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-151"><a href="#cb26-151" aria-hidden="true" tabindex="-1"></a>      <span class="at">Type =</span> results<span class="sc">$</span>Type[<span class="dv">1</span>],</span>
<span id="cb26-152"><a href="#cb26-152" aria-hidden="true" tabindex="-1"></a>      <span class="at">Sample =</span> sample_name,</span>
<span id="cb26-153"><a href="#cb26-153" aria-hidden="true" tabindex="-1"></a>      <span class="at">Comment =</span> <span class="fu">paste</span>(<span class="st">"The best match:"</span>, results<span class="sc">$</span>Fraction_Comp_1[<span class="dv">1</span>], <span class="st">"% of "</span>, results<span class="sc">$</span>Comp_1[<span class="dv">1</span>], <span class="st">" and "</span>, <span class="dv">100</span> <span class="sc">-</span> results<span class="sc">$</span>Fraction_Comp_1[<span class="dv">1</span>], <span class="st">"% of "</span>, results<span class="sc">$</span>Comp_2[<span class="dv">1</span>])</span>
<span id="cb26-154"><a href="#cb26-154" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb26-155"><a href="#cb26-155" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="st">"Total concentration, ng/µL"</span> <span class="ot">=</span> <span class="st">"median(Concentration)"</span>)</span>
<span id="cb26-156"><a href="#cb26-156" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-157"><a href="#cb26-157" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine results for all samples into a single dataframe</span></span>
<span id="cb26-158"><a href="#cb26-158" aria-hidden="true" tabindex="-1"></a>  all_results_df_SCCPs <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(all_results, <span class="at">.id =</span> <span class="st">"Sample"</span>)</span>
<span id="cb26-159"><a href="#cb26-159" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-160"><a href="#cb26-160" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print or further process the combined results dataframe</span></span>
<span id="cb26-161"><a href="#cb26-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(all_results_df_SCCPs)</span>
<span id="cb26-162"><a href="#cb26-162" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print results output</span></span>
<span id="cb26-163"><a href="#cb26-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(results_output_SCCPs)</span>
<span id="cb26-164"><a href="#cb26-164" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-165"><a href="#cb26-165" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing sample: NIST_R1"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `Type = results$Type[1]`.
Caused by warning:
! Unknown or uninitialised column: `Type`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 37 × 33
   Sample  `Replicate Name` `Sample Type` Homologue  `Molecule Formula`
   &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;         &lt;chr&gt;      &lt;lgl&gt;             
 1 NIST_R1 NIST_R1          Unknown       C10H19Cl3  NA                
 2 NIST_R1 NIST_R1          Unknown       C10H18Cl4  NA                
 3 NIST_R1 NIST_R1          Unknown       C10H17Cl5  NA                
 4 NIST_R1 NIST_R1          Unknown       C10H16Cl6  NA                
 5 NIST_R1 NIST_R1          Unknown       C10H15Cl7  NA                
 6 NIST_R1 NIST_R1          Unknown       C10H14Cl8  NA                
 7 NIST_R1 NIST_R1          Unknown       C10H13Cl9  NA                
 8 NIST_R1 NIST_R1          Unknown       C10H12Cl10 NA                
 9 NIST_R1 NIST_R1          Unknown       C11H21Cl3  NA                
10 NIST_R1 NIST_R1          Unknown       C11H20Cl4  NA                
# ℹ 27 more rows
# ℹ 28 more variables: `Precursor Mz` &lt;dbl&gt;, Quantitative &lt;lgl&gt;,
#   `Isotope Label Type` &lt;chr&gt;, `Explicit Retention Time` &lt;dbl&gt;,
#   `Explicit Retention Time Window` &lt;dbl&gt;, `Molecule List` &lt;chr&gt;,
#   `Product Adduct` &lt;chr&gt;, `Precursor Adduct` &lt;chr&gt;, Area &lt;dbl&gt;,
#   `Normalized Area` &lt;dbl&gt;, `Normalization Method` &lt;chr&gt;,
#   `Limit Of Detection` &lt;lgl&gt;, `Analyte Concentration` &lt;dbl&gt;, …
# A tibble: 1 × 3
  `Total concentration, ng/µL` Sample  Comment                                  
                         &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;                                    
1                         27.0 NIST_R1 The best match: 1 % of  A- SCCPs  and  9…
[1] "Processing sample: NIST_R2"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `Type = results$Type[1]`.
Caused by warning:
! Unknown or uninitialised column: `Type`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 74 × 33
   Sample  `Replicate Name` `Sample Type` Homologue  `Molecule Formula`
   &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;         &lt;chr&gt;      &lt;lgl&gt;             
 1 NIST_R1 NIST_R1          Unknown       C10H19Cl3  NA                
 2 NIST_R1 NIST_R1          Unknown       C10H18Cl4  NA                
 3 NIST_R1 NIST_R1          Unknown       C10H17Cl5  NA                
 4 NIST_R1 NIST_R1          Unknown       C10H16Cl6  NA                
 5 NIST_R1 NIST_R1          Unknown       C10H15Cl7  NA                
 6 NIST_R1 NIST_R1          Unknown       C10H14Cl8  NA                
 7 NIST_R1 NIST_R1          Unknown       C10H13Cl9  NA                
 8 NIST_R1 NIST_R1          Unknown       C10H12Cl10 NA                
 9 NIST_R1 NIST_R1          Unknown       C11H21Cl3  NA                
10 NIST_R1 NIST_R1          Unknown       C11H20Cl4  NA                
# ℹ 64 more rows
# ℹ 28 more variables: `Precursor Mz` &lt;dbl&gt;, Quantitative &lt;lgl&gt;,
#   `Isotope Label Type` &lt;chr&gt;, `Explicit Retention Time` &lt;dbl&gt;,
#   `Explicit Retention Time Window` &lt;dbl&gt;, `Molecule List` &lt;chr&gt;,
#   `Product Adduct` &lt;chr&gt;, `Precursor Adduct` &lt;chr&gt;, Area &lt;dbl&gt;,
#   `Normalized Area` &lt;dbl&gt;, `Normalization Method` &lt;chr&gt;,
#   `Limit Of Detection` &lt;lgl&gt;, `Analyte Concentration` &lt;dbl&gt;, …
# A tibble: 1 × 3
  `Total concentration, ng/µL` Sample  Comment                                  
                         &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;                                    
1                         26.9 NIST_R2 The best match: 1 % of  A- SCCPs  and  9…
[1] "Processing sample: NIST_R3"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `Type = results$Type[1]`.
Caused by warning:
! Unknown or uninitialised column: `Type`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 111 × 33
   Sample  `Replicate Name` `Sample Type` Homologue  `Molecule Formula`
   &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;         &lt;chr&gt;      &lt;lgl&gt;             
 1 NIST_R1 NIST_R1          Unknown       C10H19Cl3  NA                
 2 NIST_R1 NIST_R1          Unknown       C10H18Cl4  NA                
 3 NIST_R1 NIST_R1          Unknown       C10H17Cl5  NA                
 4 NIST_R1 NIST_R1          Unknown       C10H16Cl6  NA                
 5 NIST_R1 NIST_R1          Unknown       C10H15Cl7  NA                
 6 NIST_R1 NIST_R1          Unknown       C10H14Cl8  NA                
 7 NIST_R1 NIST_R1          Unknown       C10H13Cl9  NA                
 8 NIST_R1 NIST_R1          Unknown       C10H12Cl10 NA                
 9 NIST_R1 NIST_R1          Unknown       C11H21Cl3  NA                
10 NIST_R1 NIST_R1          Unknown       C11H20Cl4  NA                
# ℹ 101 more rows
# ℹ 28 more variables: `Precursor Mz` &lt;dbl&gt;, Quantitative &lt;lgl&gt;,
#   `Isotope Label Type` &lt;chr&gt;, `Explicit Retention Time` &lt;dbl&gt;,
#   `Explicit Retention Time Window` &lt;dbl&gt;, `Molecule List` &lt;chr&gt;,
#   `Product Adduct` &lt;chr&gt;, `Precursor Adduct` &lt;chr&gt;, Area &lt;dbl&gt;,
#   `Normalized Area` &lt;dbl&gt;, `Normalization Method` &lt;chr&gt;,
#   `Limit Of Detection` &lt;lgl&gt;, `Analyte Concentration` &lt;dbl&gt;, …
# A tibble: 1 × 3
  `Total concentration, ng/µL` Sample  Comment                                  
                         &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;                                    
1                         42.3 NIST_R3 The best match: 1 % of  A- SCCPs  and  9…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################VIEW RESULTS############################################</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a><span class="co">#View Overview</span></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(all_results_df_SCCPs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 111 × 33
   Sample  `Replicate Name` `Sample Type` Homologue  `Molecule Formula`
   &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;         &lt;chr&gt;      &lt;lgl&gt;             
 1 NIST_R1 NIST_R1          Unknown       C10H19Cl3  NA                
 2 NIST_R1 NIST_R1          Unknown       C10H18Cl4  NA                
 3 NIST_R1 NIST_R1          Unknown       C10H17Cl5  NA                
 4 NIST_R1 NIST_R1          Unknown       C10H16Cl6  NA                
 5 NIST_R1 NIST_R1          Unknown       C10H15Cl7  NA                
 6 NIST_R1 NIST_R1          Unknown       C10H14Cl8  NA                
 7 NIST_R1 NIST_R1          Unknown       C10H13Cl9  NA                
 8 NIST_R1 NIST_R1          Unknown       C10H12Cl10 NA                
 9 NIST_R1 NIST_R1          Unknown       C11H21Cl3  NA                
10 NIST_R1 NIST_R1          Unknown       C11H20Cl4  NA                
# ℹ 101 more rows
# ℹ 28 more variables: `Precursor Mz` &lt;dbl&gt;, Quantitative &lt;lgl&gt;,
#   `Isotope Label Type` &lt;chr&gt;, `Explicit Retention Time` &lt;dbl&gt;,
#   `Explicit Retention Time Window` &lt;dbl&gt;, `Molecule List` &lt;chr&gt;,
#   `Product Adduct` &lt;chr&gt;, `Precursor Adduct` &lt;chr&gt;, Area &lt;dbl&gt;,
#   `Normalized Area` &lt;dbl&gt;, `Normalization Method` &lt;chr&gt;,
#   `Limit Of Detection` &lt;lgl&gt;, `Analyte Concentration` &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co">#View graph, REPLACE THE NAME OF THE SAMPLE YOU WANT TO SEE, another option is to open the list from the Environment and from there open each plot</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>all_plots[[<span class="st">"NIST_R1"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-1-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>all_plots[[<span class="st">"NIST_R2"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-1-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>all_plots[[<span class="st">"NIST_R3"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-1-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="do">#################################################################################################</span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="do">##################################### MCCPs##################################################</span></span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################################################################</span></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################################################################################</span></span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true" tabindex="-1"></a><span class="do">################################ PREPARE THE STANDARDS FOR CALIBRATION #####################################################</span></span>
<span id="cb261-7"><a href="#cb261-7" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################################################</span></span>
<span id="cb261-8"><a href="#cb261-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-9"><a href="#cb261-9" aria-hidden="true" tabindex="-1"></a><span class="do">########################### STANDARDS A #############################################################</span></span>
<span id="cb261-10"><a href="#cb261-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the file</span></span>
<span id="cb261-11"><a href="#cb261-11" aria-hidden="true" tabindex="-1"></a>TESTING <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"F:/LINKOPING/Manuscripts/Skyline/Skyline/OrbitrapDust.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb261-12"><a href="#cb261-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span>)) </span>
<span id="cb261-13"><a href="#cb261-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-14"><a href="#cb261-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values in the Response_factor column with 0</span></span>
<span id="cb261-15"><a href="#cb261-15" aria-hidden="true" tabindex="-1"></a>TESTING <span class="ot">&lt;-</span> TESTING <span class="sc">%&gt;%</span></span>
<span id="cb261-16"><a href="#cb261-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>) <span class="sc">|</span> <span class="fu">is.nan</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>), <span class="dv">0</span>, <span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>)) <span class="co">#Replace with 0</span></span>
<span id="cb261-17"><a href="#cb261-17" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb261-18"><a href="#cb261-18" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb261-19"><a href="#cb261-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-20"><a href="#cb261-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create molecule names</span></span>
<span id="cb261-21"><a href="#cb261-21" aria-hidden="true" tabindex="-1"></a>create_molecule_name <span class="ot">&lt;-</span> <span class="cf">function</span>(i, j) {</span>
<span id="cb261-22"><a href="#cb261-22" aria-hidden="true" tabindex="-1"></a>  molecule_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"C"</span>, i, <span class="st">"H"</span>, (<span class="dv">2</span> <span class="sc">*</span> i) <span class="sc">+</span> <span class="dv">2</span> <span class="sc">-</span> j, <span class="st">"Cl"</span>, j)</span>
<span id="cb261-23"><a href="#cb261-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(molecule_name)</span>
<span id="cb261-24"><a href="#cb261-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb261-25"><a href="#cb261-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-26"><a href="#cb261-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty list to store plots and calibration results</span></span>
<span id="cb261-27"><a href="#cb261-27" aria-hidden="true" tabindex="-1"></a>plotsA <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb261-28"><a href="#cb261-28" aria-hidden="true" tabindex="-1"></a>calibration_resultsA <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">STD_code =</span> <span class="fu">character</span>(),</span>
<span id="cb261-29"><a href="#cb261-29" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Reference_standard =</span> <span class="fu">character</span>(),</span>
<span id="cb261-30"><a href="#cb261-30" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Chain_length =</span> <span class="fu">character</span>(),</span>
<span id="cb261-31"><a href="#cb261-31" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Type =</span> <span class="fu">character</span>(),</span>
<span id="cb261-32"><a href="#cb261-32" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Homologue =</span> <span class="fu">character</span>(),</span>
<span id="cb261-33"><a href="#cb261-33" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Response_factor =</span> <span class="fu">numeric</span>(),</span>
<span id="cb261-34"><a href="#cb261-34" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Intercept =</span> <span class="fu">numeric</span>(),</span>
<span id="cb261-35"><a href="#cb261-35" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">R_squared =</span> <span class="fu">numeric</span>(),</span>
<span id="cb261-36"><a href="#cb261-36" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb261-37"><a href="#cb261-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-38"><a href="#cb261-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the range of i and j</span></span>
<span id="cb261-39"><a href="#cb261-39" aria-hidden="true" tabindex="-1"></a>i_values <span class="ot">&lt;-</span> <span class="dv">14</span><span class="sc">:</span><span class="dv">17</span></span>
<span id="cb261-40"><a href="#cb261-40" aria-hidden="true" tabindex="-1"></a>j_values <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb261-41"><a href="#cb261-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Nested loops to iterate over i and j</span></span>
<span id="cb261-42"><a href="#cb261-42" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> i_values) {</span>
<span id="cb261-43"><a href="#cb261-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> j_values) {</span>
<span id="cb261-44"><a href="#cb261-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create molecule name</span></span>
<span id="cb261-45"><a href="#cb261-45" aria-hidden="true" tabindex="-1"></a>    molecule_name <span class="ot">&lt;-</span> <span class="fu">create_molecule_name</span>(i, j)</span>
<span id="cb261-46"><a href="#cb261-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb261-47"><a href="#cb261-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter data for the current molecule</span></span>
<span id="cb261-48"><a href="#cb261-48" aria-hidden="true" tabindex="-1"></a>    filtered_dataA <span class="ot">&lt;-</span> TESTING <span class="sc">|&gt;</span></span>
<span id="cb261-49"><a href="#cb261-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="st">`</span><span class="at">Isotope Label Type</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Quan"</span>, Molecule <span class="sc">==</span> molecule_name, Note <span class="sc">==</span> <span class="st">"D"</span>)<span class="sc">|&gt;</span> </span>
<span id="cb261-50"><a href="#cb261-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C9"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration vSCCPs</span></span>
<span id="cb261-51"><a href="#cb261-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C10"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration SCCPs</span></span>
<span id="cb261-52"><a href="#cb261-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C11"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration SCCPs</span></span>
<span id="cb261-53"><a href="#cb261-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C12"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration SCCPs</span></span>
<span id="cb261-54"><a href="#cb261-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C13"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span><span class="co">#Exclude the calibration SCCPs</span></span>
<span id="cb261-55"><a href="#cb261-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"IS"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> <span class="co">#Exclude the calibration IS</span></span>
<span id="cb261-56"><a href="#cb261-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"RS"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="co">#Exclude the calibration RS</span></span>
<span id="cb261-57"><a href="#cb261-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb261-58"><a href="#cb261-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if there are any non-NA cases in the filtered data</span></span>
<span id="cb261-59"><a href="#cb261-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(filtered_dataA<span class="sc">$</span><span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>)) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">||</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(filtered_dataA<span class="sc">$</span><span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span>)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb261-60"><a href="#cb261-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"No valid cases for fitting the model for molecule:"</span>, molecule_name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb261-61"><a href="#cb261-61" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb261-62"><a href="#cb261-62" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Fit linear model to the data</span></span>
<span id="cb261-63"><a href="#cb261-63" aria-hidden="true" tabindex="-1"></a>      lm_modelA <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span>, <span class="at">data =</span> filtered_dataA)</span>
<span id="cb261-64"><a href="#cb261-64" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb261-65"><a href="#cb261-65" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Extract slope and intercept from the model</span></span>
<span id="cb261-66"><a href="#cb261-66" aria-hidden="true" tabindex="-1"></a>      slopeA <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm_modelA)[<span class="dv">2</span>]</span>
<span id="cb261-67"><a href="#cb261-67" aria-hidden="true" tabindex="-1"></a>      interceptA <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm_modelA)[<span class="dv">1</span>]</span>
<span id="cb261-68"><a href="#cb261-68" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb261-69"><a href="#cb261-69" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate R-squared</span></span>
<span id="cb261-70"><a href="#cb261-70" aria-hidden="true" tabindex="-1"></a>      R_squaredA <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_modelA)<span class="sc">$</span>r.squared</span>
<span id="cb261-71"><a href="#cb261-71" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb261-72"><a href="#cb261-72" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Determine the type based on the value of i</span></span>
<span id="cb261-73"><a href="#cb261-73" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">&gt;=</span> <span class="dv">10</span> <span class="sc">&amp;&amp;</span> i <span class="sc">&lt;=</span> <span class="dv">13</span>) {</span>
<span id="cb261-74"><a href="#cb261-74" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"SCCPs"</span></span>
<span id="cb261-75"><a href="#cb261-75" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">&gt;=</span> <span class="dv">14</span> <span class="sc">&amp;&amp;</span> i <span class="sc">&lt;=</span> <span class="dv">17</span>) {</span>
<span id="cb261-76"><a href="#cb261-76" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"MCCPs"</span></span>
<span id="cb261-77"><a href="#cb261-77" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;&amp;</span> i <span class="sc">&lt;=</span> <span class="dv">30</span>) {</span>
<span id="cb261-78"><a href="#cb261-78" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"LCCPs"</span></span>
<span id="cb261-79"><a href="#cb261-79" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb261-80"><a href="#cb261-80" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"Unknown"</span></span>
<span id="cb261-81"><a href="#cb261-81" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb261-82"><a href="#cb261-82" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb261-83"><a href="#cb261-83" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Store the calibration results in the data frame, create the columns and values that we need to fit with the next script (the one for the deconvolution paper published by I don't remember)</span></span>
<span id="cb261-84"><a href="#cb261-84" aria-hidden="true" tabindex="-1"></a>      calibration_resultsA <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calibration_resultsA, </span>
<span id="cb261-85"><a href="#cb261-85" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">data.frame</span>(<span class="at">STD_code =</span> <span class="fu">paste</span>(<span class="st">"A-"</span>, type),</span>
<span id="cb261-86"><a href="#cb261-86" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Reference_standard =</span> <span class="fu">paste</span>(type, <span class="st">"C"</span>, i, <span class="st">"Cl%"</span>, <span class="st">"52"</span>),</span>
<span id="cb261-87"><a href="#cb261-87" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Chain_length =</span> <span class="fu">paste</span>(<span class="st">"C"</span>,i),</span>
<span id="cb261-88"><a href="#cb261-88" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Type =</span> type,</span>
<span id="cb261-89"><a href="#cb261-89" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Homologue =</span> molecule_name,</span>
<span id="cb261-90"><a href="#cb261-90" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Response_factor =</span> <span class="fu">round</span>(slopeA),</span>
<span id="cb261-91"><a href="#cb261-91" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Intercept =</span> interceptA,</span>
<span id="cb261-92"><a href="#cb261-92" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">R_squared =</span> R_squaredA))</span>
<span id="cb261-93"><a href="#cb261-93" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb261-94"><a href="#cb261-94" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb261-95"><a href="#cb261-95" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create plot for the current molecule</span></span>
<span id="cb261-96"><a href="#cb261-96" aria-hidden="true" tabindex="-1"></a>      plotA <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_dataA, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb261-97"><a href="#cb261-97" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb261-98"><a href="#cb261-98" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb261-99"><a href="#cb261-99" aria-hidden="true" tabindex="-1"></a>                    <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb261-100"><a href="#cb261-100" aria-hidden="true" tabindex="-1"></a>                    <span class="at">colour =</span> <span class="st">"orange"</span>,</span>
<span id="cb261-101"><a href="#cb261-101" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb261-102"><a href="#cb261-102" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb261-103"><a href="#cb261-103" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">"`Normalized Area`"</span>) <span class="sc">+</span></span>
<span id="cb261-104"><a href="#cb261-104" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Molecule:"</span>, molecule_name))</span>
<span id="cb261-105"><a href="#cb261-105" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb261-106"><a href="#cb261-106" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Store the plot in the list</span></span>
<span id="cb261-107"><a href="#cb261-107" aria-hidden="true" tabindex="-1"></a>      plotsA[[<span class="fu">paste</span>(<span class="st">"Molecule"</span>, molecule_name)]] <span class="ot">&lt;-</span> plotA</span>
<span id="cb261-108"><a href="#cb261-108" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb261-109"><a href="#cb261-109" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb261-110"><a href="#cb261-110" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb261-111"><a href="#cb261-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the data frame with calibration results</span></span>
<span id="cb261-112"><a href="#cb261-112" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(calibration_resultsA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          STD_code Reference_standard Chain_length  Type
`Analyte Concentration`   A- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`1  A- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`2  A- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`3  A- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`4  A- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`5  A- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`6  A- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`7  A- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`8  A- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`9  A- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`10 A- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`11 A- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`12 A- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`13 A- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`14 A- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`15 A- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`16 A- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`17 A- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`18 A- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`19 A- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`20 A- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`21 A- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`22 A- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`23 A- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`24 A- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`25 A- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`26 A- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`27 A- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`28 A- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`29 A- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`30 A- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`31 A- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`32 A- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`33 A- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`34 A- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`35 A- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`36 A- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`37 A- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`38 A- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`39 A- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
                           Homologue Response_factor     Intercept    R_squared
`Analyte Concentration`    C14H27Cl3               0  0.0017003140 4.304615e-02
`Analyte Concentration`1   C14H26Cl4               0  0.0008241879 4.116186e-02
`Analyte Concentration`2   C14H25Cl5               0 -0.3892610685 9.944278e-01
`Analyte Concentration`3   C14H24Cl6               5 -2.0308929823 9.937782e-01
`Analyte Concentration`4   C14H23Cl7               4 -1.6593492680 9.931098e-01
`Analyte Concentration`5   C14H22Cl8               1 -0.7147121462 9.944438e-01
`Analyte Concentration`6   C14H21Cl9               0 -0.0808628901 9.625424e-01
`Analyte Concentration`7  C14H20Cl10               0  0.0015083225 3.203498e-02
`Analyte Concentration`8  C14H19Cl11               0  0.0010465048 1.985181e-01
`Analyte Concentration`9  C14H18Cl12               0  0.0021332461 6.063778e-01
`Analyte Concentration`10  C15H29Cl3               0  0.0014776800 1.488301e-02
`Analyte Concentration`11  C15H28Cl4               0  0.0018666802 8.402285e-01
`Analyte Concentration`12  C15H27Cl5               0 -0.1658439977 9.690529e-01
`Analyte Concentration`13  C15H26Cl6               1 -1.0277370478 9.952507e-01
`Analyte Concentration`14  C15H25Cl7               1 -0.8212409809 9.941096e-01
`Analyte Concentration`15  C15H24Cl8               0 -0.5257671878 9.823084e-01
`Analyte Concentration`16  C15H23Cl9               0 -0.0121669930 9.660773e-01
`Analyte Concentration`17 C15H22Cl10               0  0.0002962944 3.287503e-01
`Analyte Concentration`18 C15H21Cl11               0  0.0028195556 1.384424e-01
`Analyte Concentration`19 C15H20Cl12               0  0.0014444433 1.166346e-02
`Analyte Concentration`20  C16H31Cl3               0  0.0014518904 1.707324e-01
`Analyte Concentration`21  C16H30Cl4               0  0.0010497192 4.091085e-02
`Analyte Concentration`22  C16H29Cl5               0 -0.0014107501 9.296265e-01
`Analyte Concentration`23  C16H28Cl6               0 -0.1555632282 9.629873e-01
`Analyte Concentration`24  C16H27Cl7               0 -0.1876878261 9.637249e-01
`Analyte Concentration`25  C16H26Cl8               0 -0.0230057090 9.603692e-01
`Analyte Concentration`26  C16H25Cl9               0  0.0005816779 2.244421e-01
`Analyte Concentration`27 C16H24Cl10               0  0.0000000000          NaN
`Analyte Concentration`28 C16H23Cl11               0  0.0013279994 4.542837e-03
`Analyte Concentration`29 C16H22Cl12               0  0.0017087987 3.169092e-02
`Analyte Concentration`30  C17H33Cl3               0  0.0013559775 6.463146e-03
`Analyte Concentration`31  C17H32Cl4               0  0.0015222721 3.220568e-01
`Analyte Concentration`32  C17H31Cl5               0  0.0020679379 3.457182e-01
`Analyte Concentration`33  C17H30Cl6               0  0.0010798361 2.808100e-01
`Analyte Concentration`34  C17H29Cl7               0 -0.0007166789 8.948197e-01
`Analyte Concentration`35  C17H28Cl8               0 -0.0001043101 9.516338e-01
`Analyte Concentration`36  C17H27Cl9               0  0.0044690628 3.043795e-02
`Analyte Concentration`37 C17H26Cl10               0  0.0010938527 5.042150e-02
`Analyte Concentration`38 C17H25Cl11               0  0.0014702390 9.594975e-05
`Analyte Concentration`39 C17H24Cl12               0  0.0017722116 3.492723e-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange plots in a grid</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>calibration_curves_gridA <span class="ot">&lt;-</span> plotsA[[<span class="dv">1</span>]]</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(plotsA)) {</span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>  calibration_curves_gridA <span class="ot">&lt;-</span> calibration_curves_gridA <span class="sc">+</span> plotsA[[i]]</span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the grid of calibration curves</span></span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a>calibration_curves_gridA</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-1-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="do">########################### STANDARDS B #####################################################################################</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values in the Response_factor column with 0</span></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a>TESTING <span class="ot">&lt;-</span> TESTING <span class="sc">|&gt;</span> </span>
<span id="cb265-6"><a href="#cb265-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">replace_na</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>, <span class="dv">0</span>))</span>
<span id="cb265-7"><a href="#cb265-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-8"><a href="#cb265-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create molecule names</span></span>
<span id="cb265-9"><a href="#cb265-9" aria-hidden="true" tabindex="-1"></a>create_molecule_name <span class="ot">&lt;-</span> <span class="cf">function</span>(i, j) {</span>
<span id="cb265-10"><a href="#cb265-10" aria-hidden="true" tabindex="-1"></a>  molecule_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"C"</span>, i, <span class="st">"H"</span>, (<span class="dv">2</span> <span class="sc">*</span> i) <span class="sc">+</span> <span class="dv">2</span> <span class="sc">-</span> j, <span class="st">"Cl"</span>, j)</span>
<span id="cb265-11"><a href="#cb265-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(molecule_name)</span>
<span id="cb265-12"><a href="#cb265-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb265-13"><a href="#cb265-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-14"><a href="#cb265-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty list to store plots and calibration results</span></span>
<span id="cb265-15"><a href="#cb265-15" aria-hidden="true" tabindex="-1"></a>plotsB <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb265-16"><a href="#cb265-16" aria-hidden="true" tabindex="-1"></a>calibration_resultsB <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">STD_code =</span> <span class="fu">character</span>(),</span>
<span id="cb265-17"><a href="#cb265-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Reference_standard =</span> <span class="fu">character</span>(),</span>
<span id="cb265-18"><a href="#cb265-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Chain_length =</span> <span class="fu">character</span>(),</span>
<span id="cb265-19"><a href="#cb265-19" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Type =</span> <span class="fu">character</span>(),</span>
<span id="cb265-20"><a href="#cb265-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Homologue =</span> <span class="fu">character</span>(),</span>
<span id="cb265-21"><a href="#cb265-21" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Response_factor =</span> <span class="fu">numeric</span>(),</span>
<span id="cb265-22"><a href="#cb265-22" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">Intercept =</span> <span class="fu">numeric</span>(),</span>
<span id="cb265-23"><a href="#cb265-23" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">R_squared =</span> <span class="fu">numeric</span>(),</span>
<span id="cb265-24"><a href="#cb265-24" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb265-25"><a href="#cb265-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-26"><a href="#cb265-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the range of i and j</span></span>
<span id="cb265-27"><a href="#cb265-27" aria-hidden="true" tabindex="-1"></a>i_values <span class="ot">&lt;-</span> <span class="dv">14</span><span class="sc">:</span><span class="dv">17</span></span>
<span id="cb265-28"><a href="#cb265-28" aria-hidden="true" tabindex="-1"></a>j_values <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb265-29"><a href="#cb265-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Nested loops to iterate over i and j</span></span>
<span id="cb265-30"><a href="#cb265-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> i_values) {</span>
<span id="cb265-31"><a href="#cb265-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> j_values) {</span>
<span id="cb265-32"><a href="#cb265-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create molecule name</span></span>
<span id="cb265-33"><a href="#cb265-33" aria-hidden="true" tabindex="-1"></a>    molecule_name <span class="ot">&lt;-</span> <span class="fu">create_molecule_name</span>(i, j)</span>
<span id="cb265-34"><a href="#cb265-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb265-35"><a href="#cb265-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter data for the current molecule</span></span>
<span id="cb265-36"><a href="#cb265-36" aria-hidden="true" tabindex="-1"></a>    filtered_dataB <span class="ot">&lt;-</span> TESTING <span class="sc">|&gt;</span></span>
<span id="cb265-37"><a href="#cb265-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="st">`</span><span class="at">Isotope Label Type</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Quan"</span>, Molecule <span class="sc">==</span> molecule_name, Note <span class="sc">==</span> <span class="st">"E"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb265-38"><a href="#cb265-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C9"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration vSCCPs</span></span>
<span id="cb265-39"><a href="#cb265-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C10"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration SCCPs</span></span>
<span id="cb265-40"><a href="#cb265-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C11"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration SCCPs</span></span>
<span id="cb265-41"><a href="#cb265-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C12"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration SCCPs</span></span>
<span id="cb265-42"><a href="#cb265-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"C13"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span><span class="co">#Exclude the calibration SCCPs</span></span>
<span id="cb265-43"><a href="#cb265-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"IS"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> <span class="co">#Exclude the calibration IS</span></span>
<span id="cb265-44"><a href="#cb265-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(Molecule, <span class="st">"RS"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="co">#Exclude the calibration RS </span></span>
<span id="cb265-45"><a href="#cb265-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb265-46"><a href="#cb265-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if there are any non-NA cases in the filtered data</span></span>
<span id="cb265-47"><a href="#cb265-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(filtered_dataB<span class="sc">$</span><span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>)) <span class="sc">==</span> <span class="dv">0</span> <span class="sc">||</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(filtered_dataB<span class="sc">$</span><span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span>)) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb265-48"><a href="#cb265-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"No valid cases for fitting the model for molecule:"</span>, molecule_name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb265-49"><a href="#cb265-49" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb265-50"><a href="#cb265-50" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Fit linear model to the data</span></span>
<span id="cb265-51"><a href="#cb265-51" aria-hidden="true" tabindex="-1"></a>      lm_modelB <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span>, <span class="at">data =</span> filtered_dataB)</span>
<span id="cb265-52"><a href="#cb265-52" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb265-53"><a href="#cb265-53" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Extract slope and intercept from the model</span></span>
<span id="cb265-54"><a href="#cb265-54" aria-hidden="true" tabindex="-1"></a>      slopeB <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm_modelB)[<span class="dv">2</span>]</span>
<span id="cb265-55"><a href="#cb265-55" aria-hidden="true" tabindex="-1"></a>      interceptB <span class="ot">&lt;-</span> <span class="fu">coef</span>(lm_modelB)[<span class="dv">1</span>]</span>
<span id="cb265-56"><a href="#cb265-56" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb265-57"><a href="#cb265-57" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate R-squared</span></span>
<span id="cb265-58"><a href="#cb265-58" aria-hidden="true" tabindex="-1"></a>      R_squaredB <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_modelB)<span class="sc">$</span>r.squared</span>
<span id="cb265-59"><a href="#cb265-59" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb265-60"><a href="#cb265-60" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Determine the type based on the value of i</span></span>
<span id="cb265-61"><a href="#cb265-61" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">&gt;=</span> <span class="dv">10</span> <span class="sc">&amp;&amp;</span> i <span class="sc">&lt;=</span> <span class="dv">13</span>) {</span>
<span id="cb265-62"><a href="#cb265-62" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"SCCPs"</span></span>
<span id="cb265-63"><a href="#cb265-63" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">&gt;=</span> <span class="dv">14</span> <span class="sc">&amp;&amp;</span> i <span class="sc">&lt;=</span> <span class="dv">17</span>) {</span>
<span id="cb265-64"><a href="#cb265-64" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"MCCPs"</span></span>
<span id="cb265-65"><a href="#cb265-65" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;&amp;</span> i <span class="sc">&lt;=</span> <span class="dv">30</span>) {</span>
<span id="cb265-66"><a href="#cb265-66" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"LCCPs"</span></span>
<span id="cb265-67"><a href="#cb265-67" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb265-68"><a href="#cb265-68" aria-hidden="true" tabindex="-1"></a>        type <span class="ot">&lt;-</span> <span class="st">"Unknown"</span></span>
<span id="cb265-69"><a href="#cb265-69" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb265-70"><a href="#cb265-70" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb265-71"><a href="#cb265-71" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Store the calibration results in the data frame, create the columns and values that we need to fit with the next script (the one for the deconvolution paper published by I don't remember)</span></span>
<span id="cb265-72"><a href="#cb265-72" aria-hidden="true" tabindex="-1"></a>      calibration_resultsB <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calibration_resultsB, </span>
<span id="cb265-73"><a href="#cb265-73" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">data.frame</span>(<span class="at">STD_code =</span> <span class="fu">paste</span>(<span class="st">"B-"</span>, type),</span>
<span id="cb265-74"><a href="#cb265-74" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Reference_standard =</span> <span class="fu">paste</span>(type, <span class="st">"C"</span>, i, <span class="st">"Cl%"</span>, <span class="st">"52"</span>),</span>
<span id="cb265-75"><a href="#cb265-75" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Chain_length =</span> <span class="fu">paste</span>(<span class="st">"C"</span>,i),</span>
<span id="cb265-76"><a href="#cb265-76" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Type =</span> type,</span>
<span id="cb265-77"><a href="#cb265-77" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Homologue =</span> molecule_name,</span>
<span id="cb265-78"><a href="#cb265-78" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Response_factor =</span> <span class="fu">round</span>(slopeB),</span>
<span id="cb265-79"><a href="#cb265-79" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Intercept =</span> interceptB,</span>
<span id="cb265-80"><a href="#cb265-80" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">R_squared =</span> R_squaredB))</span>
<span id="cb265-81"><a href="#cb265-81" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb265-82"><a href="#cb265-82" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb265-83"><a href="#cb265-83" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Create plot for the current molecule</span></span>
<span id="cb265-84"><a href="#cb265-84" aria-hidden="true" tabindex="-1"></a>      plotB <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(filtered_dataB, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Analyte Concentration</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb265-85"><a href="#cb265-85" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb265-86"><a href="#cb265-86" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb265-87"><a href="#cb265-87" aria-hidden="true" tabindex="-1"></a>                    <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb265-88"><a href="#cb265-88" aria-hidden="true" tabindex="-1"></a>                    <span class="at">colour =</span> <span class="st">"purple"</span>,</span>
<span id="cb265-89"><a href="#cb265-89" aria-hidden="true" tabindex="-1"></a>                    <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb265-90"><a href="#cb265-90" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb265-91"><a href="#cb265-91" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ylab</span>(<span class="st">"`Normalized Area`"</span>) <span class="sc">+</span></span>
<span id="cb265-92"><a href="#cb265-92" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Molecule:"</span>, molecule_name))</span>
<span id="cb265-93"><a href="#cb265-93" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb265-94"><a href="#cb265-94" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Store the plot in the list</span></span>
<span id="cb265-95"><a href="#cb265-95" aria-hidden="true" tabindex="-1"></a>      plotsB[[<span class="fu">paste</span>(<span class="st">"Molecule"</span>, molecule_name)]] <span class="ot">&lt;-</span> plotB</span>
<span id="cb265-96"><a href="#cb265-96" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb265-97"><a href="#cb265-97" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb265-98"><a href="#cb265-98" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb265-99"><a href="#cb265-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the data frame with calibration results</span></span>
<span id="cb265-100"><a href="#cb265-100" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(calibration_resultsB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          STD_code Reference_standard Chain_length  Type
`Analyte Concentration`   B- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`1  B- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`2  B- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`3  B- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`4  B- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`5  B- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`6  B- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`7  B- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`8  B- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`9  B- MCCPs  MCCPs C 14 Cl% 52         C 14 MCCPs
`Analyte Concentration`10 B- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`11 B- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`12 B- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`13 B- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`14 B- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`15 B- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`16 B- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`17 B- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`18 B- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`19 B- MCCPs  MCCPs C 15 Cl% 52         C 15 MCCPs
`Analyte Concentration`20 B- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`21 B- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`22 B- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`23 B- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`24 B- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`25 B- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`26 B- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`27 B- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`28 B- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`29 B- MCCPs  MCCPs C 16 Cl% 52         C 16 MCCPs
`Analyte Concentration`30 B- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`31 B- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`32 B- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`33 B- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`34 B- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`35 B- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`36 B- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`37 B- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`38 B- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
`Analyte Concentration`39 B- MCCPs  MCCPs C 17 Cl% 52         C 17 MCCPs
                           Homologue Response_factor     Intercept    R_squared
`Analyte Concentration`    C14H27Cl3               0  1.605658e-03 7.534660e-03
`Analyte Concentration`1   C14H26Cl4               0  1.860452e-03 7.005732e-02
`Analyte Concentration`2   C14H25Cl5               0 -3.460395e-01 9.814838e-01
`Analyte Concentration`3   C14H24Cl6              18 -1.397630e+01 9.956750e-01
`Analyte Concentration`4   C14H23Cl7              81 -6.759452e+01 9.945448e-01
`Analyte Concentration`5   C14H22Cl8              66 -5.162676e+01 9.953740e-01
`Analyte Concentration`6   C14H21Cl9              17 -1.196821e+01 9.971627e-01
`Analyte Concentration`7  C14H20Cl10               2 -2.070270e+00 9.912357e-01
`Analyte Concentration`8  C14H19Cl11               0 -1.419678e-02 9.649365e-01
`Analyte Concentration`9  C14H18Cl12               0  1.506217e-03 1.654651e-03
`Analyte Concentration`10  C15H29Cl3               0  2.041412e-03 1.152700e-01
`Analyte Concentration`11  C15H28Cl4               0  2.110072e-03 1.955377e-01
`Analyte Concentration`12  C15H27Cl5               0 -4.370121e-02 9.539736e-01
`Analyte Concentration`13  C15H26Cl6               4 -3.875642e+00 9.935974e-01
`Analyte Concentration`14  C15H25Cl7              20 -1.740111e+01 9.942800e-01
`Analyte Concentration`15  C15H24Cl8              20 -1.512863e+01 9.963325e-01
`Analyte Concentration`16  C15H23Cl9               7 -4.994249e+00 9.979704e-01
`Analyte Concentration`17 C15H22Cl10               1 -1.565821e+00 9.798476e-01
`Analyte Concentration`18 C15H21Cl11               0 -6.822431e-03 9.604675e-01
`Analyte Concentration`19 C15H20Cl12               0  1.529575e-03 1.536233e-02
`Analyte Concentration`20  C16H31Cl3               0  1.565702e-03 1.179202e-01
`Analyte Concentration`21  C16H30Cl4               0  1.446842e-03 1.907143e-01
`Analyte Concentration`22  C16H29Cl5               0  0.000000e+00          NaN
`Analyte Concentration`23  C16H28Cl6               0 -5.071733e-01 9.635098e-01
`Analyte Concentration`24  C16H27Cl7               2 -2.263614e+00 9.905136e-01
`Analyte Concentration`25  C16H26Cl8               3 -2.562330e+00 9.946589e-01
`Analyte Concentration`26  C16H25Cl9               1 -1.637643e+00 9.885519e-01
`Analyte Concentration`27 C16H24Cl10               0 -2.769222e-01 9.587405e-01
`Analyte Concentration`28 C16H23Cl11               0  7.283588e-04 4.158994e-01
`Analyte Concentration`29 C16H22Cl12               0  2.155477e-03 6.228044e-03
`Analyte Concentration`30  C17H33Cl3               0  1.786631e-03 9.897689e-04
`Analyte Concentration`31  C17H32Cl4               0  1.662951e-03 4.577707e-02
`Analyte Concentration`32  C17H31Cl5               0  6.429657e-04 1.461055e-01
`Analyte Concentration`33  C17H30Cl6               0 -1.414370e-03 8.751862e-01
`Analyte Concentration`34  C17H29Cl7               0 -2.195853e-01 9.578924e-01
`Analyte Concentration`35  C17H28Cl8               0 -4.919519e-01 9.628383e-01
`Analyte Concentration`36  C17H27Cl9               0 -2.834438e-01 9.594222e-01
`Analyte Concentration`37 C17H26Cl10               0 -3.890729e-03 9.772849e-01
`Analyte Concentration`38 C17H25Cl11               0  1.369681e-03 1.861675e-02
`Analyte Concentration`39 C17H24Cl12               0  1.919165e-03 1.670503e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange plots in a grid</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>calibration_curves_gridB <span class="ot">&lt;-</span> plotsB[[<span class="dv">1</span>]]</span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(plotsB)) {</span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>  calibration_curves_gridB <span class="ot">&lt;-</span> calibration_curves_gridB <span class="sc">+</span> plotsB[[i]]</span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the grid of calibration curves</span></span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a>calibration_curves_gridB</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-1-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="do">########################### COMBINE STNADARDS A AND B ######################################################################</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>combined_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(calibration_resultsA, calibration_resultsB)</span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################################################################################</span></span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a><span class="do">################################ PREPARE THE SAMPLES FOR CALIBRATION #####################################################</span></span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################################################</span></span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true" tabindex="-1"></a>TESTINGB <span class="ot">&lt;-</span> TESTING <span class="sc">|&gt;</span> </span>
<span id="cb269-12"><a href="#cb269-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Isotope Label Type</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Quan"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb269-13"><a href="#cb269-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb269-14"><a href="#cb269-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>),</span>
<span id="cb269-15"><a href="#cb269-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Chain_length =</span> <span class="fu">paste</span>(<span class="st">"C"</span>, <span class="fu">sub</span>(<span class="st">".*-C(9|10|11|12|13|14|15|16|17)$"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, <span class="st">`</span><span class="at">Molecule List</span><span class="st">`</span>)), <span class="co">#Create the columns that contains the chain length as for example C10 or C11 or C12 etc.</span></span>
<span id="cb269-16"><a href="#cb269-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="fu">ifelse</span>(</span>
<span id="cb269-17"><a href="#cb269-17" aria-hidden="true" tabindex="-1"></a>      Chain_length <span class="sc">&gt;=</span> <span class="dv">10</span> <span class="sc">&amp;</span> Chain_length <span class="sc">&lt;=</span> <span class="dv">13</span>, <span class="st">"SCCPs"</span>,</span>
<span id="cb269-18"><a href="#cb269-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(</span>
<span id="cb269-19"><a href="#cb269-19" aria-hidden="true" tabindex="-1"></a>        Chain_length <span class="sc">&gt;=</span> <span class="dv">14</span> <span class="sc">&amp;</span> Chain_length <span class="sc">&lt;=</span> <span class="dv">17</span>, <span class="st">"MCCPs"</span>,</span>
<span id="cb269-20"><a href="#cb269-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ifelse</span>(Chain_length <span class="sc">&gt;=</span> <span class="dv">18</span> <span class="sc">&amp;</span> Chain_length <span class="sc">&lt;=</span> <span class="dv">30</span>, <span class="st">"LCCPs"</span>, <span class="st">"Unknown"</span>) <span class="co">#Create the column type which should contain SCCPs, MCCPs and LCCPs depending on the chain length</span></span>
<span id="cb269-21"><a href="#cb269-21" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb269-22"><a href="#cb269-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb269-23"><a href="#cb269-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb269-24"><a href="#cb269-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Homologue =</span> Molecule) <span class="sc">|&gt;</span> </span>
<span id="cb269-25"><a href="#cb269-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( <span class="st">`</span><span class="at">Sample Type</span><span class="st">`</span> <span class="sc">!=</span> <span class="st">"Standard"</span> <span class="co">#Filter to remove the standards out of the data frame</span></span>
<span id="cb269-26"><a href="#cb269-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb269-27"><a href="#cb269-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Homologue, <span class="st">"C9"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration vSCCPs</span></span>
<span id="cb269-28"><a href="#cb269-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Homologue, <span class="st">"C10"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration SCCPs</span></span>
<span id="cb269-29"><a href="#cb269-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Homologue, <span class="st">"C11"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration SCCPs</span></span>
<span id="cb269-30"><a href="#cb269-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Homologue, <span class="st">"C12"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>))<span class="sc">|&gt;</span><span class="co">#Exclude the calibration SCCPs</span></span>
<span id="cb269-31"><a href="#cb269-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Homologue, <span class="st">"C13"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span><span class="co">#Exclude the calibration SCCPs</span></span>
<span id="cb269-32"><a href="#cb269-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Homologue, <span class="st">"IS"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> <span class="co">#Exclude the calibration IS</span></span>
<span id="cb269-33"><a href="#cb269-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(Homologue, <span class="st">"RS"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span>  <span class="co">#Exclude the calibration RS</span></span>
<span id="cb269-34"><a href="#cb269-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(<span class="st">`</span><span class="at">Replicate Name</span><span class="st">`</span>, <span class="st">"Std"</span>, <span class="at">negate =</span> <span class="cn">TRUE</span>)) <span class="co">#Exclude the calibration standards</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `Normalized Area = as.numeric(`Normalized Area`)`.
Caused by warning:
! NAs introduced by coercion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group samples for creating one data frame for each: the CALIBRATION script requires to have one data frame for each sample, so out of the current data frame we should create a new of for each of the samples</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>list_of_samples <span class="ot">&lt;-</span> <span class="fu">split</span>(TESTINGB, TESTINGB<span class="sc">$</span><span class="st">`</span><span class="at">Replicate Name</span><span class="st">`</span>)</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################################################################################</span></span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a><span class="do">########################################## CALIBRATION #####################################################</span></span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################################################</span></span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true" tabindex="-1"></a><span class="do">#####GROUP STANDARD MIXTURES USED#####</span></span>
<span id="cb271-11"><a href="#cb271-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-12"><a href="#cb271-12" aria-hidden="true" tabindex="-1"></a><span class="do">#####Set working directory#####</span></span>
<span id="cb271-13"><a href="#cb271-13" aria-hidden="true" tabindex="-1"></a>working.directory <span class="ot">&lt;-</span> <span class="st">"F:/LINKOPING/Manuscripts/Skyline/Skyline/"</span></span>
<span id="cb271-14"><a href="#cb271-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-15"><a href="#cb271-15" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################PREPARE DATASET FOR PATTERN RECONSTRUCTION#################</span></span>
<span id="cb271-16"><a href="#cb271-16" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb271-17"><a href="#cb271-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rename the file of the standards that we have created previous for calibration so it will fit the script</span></span>
<span id="cb271-18"><a href="#cb271-18" aria-hidden="true" tabindex="-1"></a>  input <span class="ot">&lt;-</span> combined_df</span>
<span id="cb271-19"><a href="#cb271-19" aria-hidden="true" tabindex="-1"></a>  input<span class="sc">$</span>STD_code <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(input<span class="sc">$</span>STD_code)</span>
<span id="cb271-20"><a href="#cb271-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-21"><a href="#cb271-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create all possible binary combinations between given calibration sets</span></span>
<span id="cb271-22"><a href="#cb271-22" aria-hidden="true" tabindex="-1"></a>  Combinations <span class="ot">&lt;-</span> <span class="fu">combn</span>(<span class="at">x =</span> <span class="fu">levels</span>(input<span class="sc">$</span>STD_code), <span class="at">m =</span> <span class="dv">2</span>, <span class="at">FUN =</span> <span class="cn">NULL</span>, <span class="at">simplify =</span> <span class="cn">TRUE</span>)</span>
<span id="cb271-23"><a href="#cb271-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-24"><a href="#cb271-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store sum RFs for each group CP standard</span></span>
<span id="cb271-25"><a href="#cb271-25" aria-hidden="true" tabindex="-1"></a>  input <span class="ot">&lt;-</span> input <span class="sc">|&gt;</span> </span>
<span id="cb271-26"><a href="#cb271-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Reference_standard) <span class="sc">|&gt;</span> </span>
<span id="cb271-27"><a href="#cb271-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Sum_response_factor =</span> <span class="fu">sum</span>(Response_factor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb271-28"><a href="#cb271-28" aria-hidden="true" tabindex="-1"></a>  input[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(input[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], as.factor)</span>
<span id="cb271-29"><a href="#cb271-29" aria-hidden="true" tabindex="-1"></a>  input<span class="sc">$</span>Response_factor[<span class="fu">is.na</span>(input<span class="sc">$</span>Response_factor)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb271-30"><a href="#cb271-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb271-31"><a href="#cb271-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-32"><a href="#cb271-32" aria-hidden="true" tabindex="-1"></a><span class="do">############################################SECTION FOR SAMPLE PROCESSING##########################</span></span>
<span id="cb271-33"><a href="#cb271-33" aria-hidden="true" tabindex="-1"></a><span class="do">## The script was made for quantifying one sample at the time, so I changed it to iterate for all the data frames of the samples</span></span>
<span id="cb271-34"><a href="#cb271-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-35"><a href="#cb271-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty list to store results for all samples</span></span>
<span id="cb271-36"><a href="#cb271-36" aria-hidden="true" tabindex="-1"></a>all_results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb271-37"><a href="#cb271-37" aria-hidden="true" tabindex="-1"></a>all_plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb271-38"><a href="#cb271-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-39"><a href="#cb271-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract unique sample names, it will give the to each "data frame"</span></span>
<span id="cb271-40"><a href="#cb271-40" aria-hidden="true" tabindex="-1"></a>unique_sample_names <span class="ot">&lt;-</span> <span class="fu">unique</span>(TESTINGB<span class="sc">$</span><span class="st">`</span><span class="at">Replicate Name</span><span class="st">`</span>)</span>
<span id="cb271-41"><a href="#cb271-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-42"><a href="#cb271-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over each unique sample name</span></span>
<span id="cb271-43"><a href="#cb271-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sample_name <span class="cf">in</span> unique_sample_names) {</span>
<span id="cb271-44"><a href="#cb271-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get the corresponding sample data frame, now I will use sample_df for further procesing</span></span>
<span id="cb271-45"><a href="#cb271-45" aria-hidden="true" tabindex="-1"></a>  sample_df <span class="ot">&lt;-</span> list_of_samples[[sample_name]]</span>
<span id="cb271-46"><a href="#cb271-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-47"><a href="#cb271-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set sample name, to see which samples it will calibrate</span></span>
<span id="cb271-48"><a href="#cb271-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Processing sample:"</span>, sample_name))</span>
<span id="cb271-49"><a href="#cb271-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-50"><a href="#cb271-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-51"><a href="#cb271-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-52"><a href="#cb271-52" aria-hidden="true" tabindex="-1"></a>  <span class="do">####################################RUN PATTERN RECONSTRUCTION FOR SELECTED (LOADED) SAMPLE####################</span></span>
<span id="cb271-53"><a href="#cb271-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">#This section is mostly how it was given, I only included the info to fill in the empty list that I created at the begging so I will get the results for each sample. I also combined all results into one data frame so I would not have one data frame for ach sample. </span></span>
<span id="cb271-54"><a href="#cb271-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-55"><a href="#cb271-55" aria-hidden="true" tabindex="-1"></a>  sample_df <span class="ot">&lt;-</span> sample_df <span class="sc">|&gt;</span> </span>
<span id="cb271-56"><a href="#cb271-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb271-57"><a href="#cb271-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">Chain_length =</span> <span class="fu">as.factor</span>(Chain_length),</span>
<span id="cb271-58"><a href="#cb271-58" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>),</span>
<span id="cb271-59"><a href="#cb271-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">Relative_distribution =</span> <span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb271-60"><a href="#cb271-60" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb271-61"><a href="#cb271-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-62"><a href="#cb271-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate relative `Normalized Area` distribution within each homologue group</span></span>
<span id="cb271-63"><a href="#cb271-63" aria-hidden="true" tabindex="-1"></a>  sample_df<span class="sc">$</span>Relative_distribution <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb271-64"><a href="#cb271-64" aria-hidden="true" tabindex="-1"></a>  sample_df<span class="sc">$</span><span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>[<span class="fu">is.na</span>(sample_df<span class="sc">$</span><span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb271-65"><a href="#cb271-65" aria-hidden="true" tabindex="-1"></a>  sample_df <span class="ot">&lt;-</span> sample_df <span class="sc">|&gt;</span>  <span class="fu">mutate</span>(<span class="at">Relative_distribution =</span> <span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb271-66"><a href="#cb271-66" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> sample_df</span>
<span id="cb271-67"><a href="#cb271-67" aria-hidden="true" tabindex="-1"></a>  results[<span class="fu">c</span>(<span class="st">"Comp_1"</span>, <span class="st">"Comp_2"</span>, <span class="st">"Fraction_Comp_1"</span>, <span class="st">"Simulated_pattern"</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb271-68"><a href="#cb271-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-69"><a href="#cb271-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Deconvolution of homologue patterns (adjust your loop accordingly)</span></span>
<span id="cb271-70"><a href="#cb271-70" aria-hidden="true" tabindex="-1"></a>  REF <span class="ot">&lt;-</span> sample_df<span class="sc">$</span>Relative_distribution</span>
<span id="cb271-71"><a href="#cb271-71" aria-hidden="true" tabindex="-1"></a>  Distance <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb271-72"><a href="#cb271-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-73"><a href="#cb271-73" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (z <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Combinations[<span class="dv">1</span>,])) {</span>
<span id="cb271-74"><a href="#cb271-74" aria-hidden="true" tabindex="-1"></a>    C_1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(input, <span class="at">subset =</span> (STD_code <span class="sc">==</span> Combinations[<span class="dv">1</span>, z]))</span>
<span id="cb271-75"><a href="#cb271-75" aria-hidden="true" tabindex="-1"></a>    C_2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(input, <span class="at">subset =</span> (STD_code <span class="sc">==</span> Combinations[<span class="dv">2</span>, z]))</span>
<span id="cb271-76"><a href="#cb271-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb271-77"><a href="#cb271-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb271-78"><a href="#cb271-78" aria-hidden="true" tabindex="-1"></a>      Combo <span class="ot">&lt;-</span> (C_1<span class="sc">$</span>Response_factor <span class="sc">*</span> j <span class="sc">+</span> C_2<span class="sc">$</span>Response_factor <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">-</span> j)) <span class="sc">/</span> <span class="fu">sum</span>((C_1<span class="sc">$</span>Response_factor <span class="sc">*</span> j <span class="sc">+</span> C_2<span class="sc">$</span>Response_factor <span class="sc">*</span> (<span class="dv">100</span> <span class="sc">-</span> j)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb271-79"><a href="#cb271-79" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb271-80"><a href="#cb271-80" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check for NA values in REF or Combo before comparison</span></span>
<span id="cb271-81"><a href="#cb271-81" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">any</span>(<span class="fu">is.na</span>(REF)) <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">any</span>(<span class="fu">is.na</span>(Combo)) <span class="sc">&amp;&amp;</span> Distance <span class="sc">&gt;</span> (<span class="fu">sum</span>(<span class="fu">sqrt</span>((REF <span class="sc">-</span> Combo)<span class="sc">^</span><span class="dv">2</span>)))) {</span>
<span id="cb271-82"><a href="#cb271-82" aria-hidden="true" tabindex="-1"></a>        results<span class="sc">$</span>Comp_1 <span class="ot">&lt;-</span> <span class="fu">as.character</span>(C_1<span class="sc">$</span>STD_code)</span>
<span id="cb271-83"><a href="#cb271-83" aria-hidden="true" tabindex="-1"></a>        results<span class="sc">$</span>Comp_2 <span class="ot">&lt;-</span> <span class="fu">as.character</span>(C_2<span class="sc">$</span>STD_code)</span>
<span id="cb271-84"><a href="#cb271-84" aria-hidden="true" tabindex="-1"></a>        results<span class="sc">$</span>Fraction_Comp_1 <span class="ot">&lt;-</span> j</span>
<span id="cb271-85"><a href="#cb271-85" aria-hidden="true" tabindex="-1"></a>        results<span class="sc">$</span>Simulated_pattern <span class="ot">&lt;-</span> Combo</span>
<span id="cb271-86"><a href="#cb271-86" aria-hidden="true" tabindex="-1"></a>        Distance <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sqrt</span>((REF <span class="sc">-</span> Combo)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb271-87"><a href="#cb271-87" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb271-88"><a href="#cb271-88" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb271-89"><a href="#cb271-89" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb271-90"><a href="#cb271-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-91"><a href="#cb271-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-92"><a href="#cb271-92" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate concentrations (ng per microliter)</span></span>
<span id="cb271-93"><a href="#cb271-93" aria-hidden="true" tabindex="-1"></a>  results<span class="sc">$</span>RF_1st <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb271-94"><a href="#cb271-94" aria-hidden="true" tabindex="-1"></a>  results<span class="sc">$</span>RF_2nd <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb271-95"><a href="#cb271-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-96"><a href="#cb271-96" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(results)) {</span>
<span id="cb271-97"><a href="#cb271-97" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>RF_1st[i] <span class="ot">&lt;-</span> input<span class="sc">$</span>Sum_response_factor[input<span class="sc">$</span>STD_code <span class="sc">==</span> results<span class="sc">$</span>Comp_1[i]]</span>
<span id="cb271-98"><a href="#cb271-98" aria-hidden="true" tabindex="-1"></a>    results<span class="sc">$</span>RF_2nd[i] <span class="ot">&lt;-</span> input<span class="sc">$</span>Sum_response_factor[input<span class="sc">$</span>STD_code <span class="sc">==</span> results<span class="sc">$</span>Comp_2[i]]</span>
<span id="cb271-99"><a href="#cb271-99" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb271-100"><a href="#cb271-100" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-101"><a href="#cb271-101" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> results <span class="sc">|&gt;</span> </span>
<span id="cb271-102"><a href="#cb271-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb271-103"><a href="#cb271-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">RF_1st =</span> <span class="fu">as.numeric</span>(RF_1st),</span>
<span id="cb271-104"><a href="#cb271-104" aria-hidden="true" tabindex="-1"></a>      <span class="at">RF_2nd =</span> <span class="fu">as.numeric</span>(RF_2nd),</span>
<span id="cb271-105"><a href="#cb271-105" aria-hidden="true" tabindex="-1"></a>      <span class="at">Concentration =</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Normalized Area</span><span class="st">`</span>) <span class="sc">/</span> (RF_1st <span class="sc">*</span> (Fraction_Comp_1 <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">+</span> RF_2nd <span class="sc">*</span> ((<span class="dv">100</span> <span class="sc">-</span> Fraction_Comp_1) <span class="sc">/</span> <span class="dv">100</span>))</span>
<span id="cb271-106"><a href="#cb271-106" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb271-107"><a href="#cb271-107" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-108"><a href="#cb271-108" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the results for the current sample in the list</span></span>
<span id="cb271-109"><a href="#cb271-109" aria-hidden="true" tabindex="-1"></a>  all_results[[sample_name]] <span class="ot">&lt;-</span> results</span>
<span id="cb271-110"><a href="#cb271-110" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-111"><a href="#cb271-111" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Visualization of results</span></span>
<span id="cb271-112"><a href="#cb271-112" aria-hidden="true" tabindex="-1"></a>  plot_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb271-113"><a href="#cb271-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">Distribution =</span> <span class="fu">c</span>(results<span class="sc">$</span>Relative_distribution, results<span class="sc">$</span>Simulated_pattern),</span>
<span id="cb271-114"><a href="#cb271-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">Homologue =</span> results<span class="sc">$</span>Homologue,</span>
<span id="cb271-115"><a href="#cb271-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">Chain_length =</span> results<span class="sc">$</span>Chain_length,</span>
<span id="cb271-116"><a href="#cb271-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">Origin =</span> <span class="fu">rep</span>(<span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">"Measured"</span>, <span class="st">"Simulated"</span>)), <span class="at">each =</span> <span class="fu">nrow</span>(results))</span>
<span id="cb271-117"><a href="#cb271-117" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb271-118"><a href="#cb271-118" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-119"><a href="#cb271-119" aria-hidden="true" tabindex="-1"></a>  plot_table<span class="sc">$</span>Homologue <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot_table<span class="sc">$</span>Homologue, <span class="at">levels =</span> <span class="fu">unique</span>(plot_table<span class="sc">$</span>Homologue))</span>
<span id="cb271-120"><a href="#cb271-120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-121"><a href="#cb271-121" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(plot_table, <span class="fu">aes</span>(<span class="at">x =</span> Homologue, <span class="at">y =</span> Distribution <span class="sc">*</span> <span class="dv">100</span>, <span class="at">fill =</span> Origin, <span class="at">colour =</span> Origin)) <span class="sc">+</span></span>
<span id="cb271-122"><a href="#cb271-122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">width =</span> <span class="fl">0.8</span>, <span class="at">size =</span> .<span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb271-123"><a href="#cb271-123" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb271-124"><a href="#cb271-124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkolivegreen3"</span>, <span class="st">"darkslategray4"</span>)) <span class="sc">+</span></span>
<span id="cb271-125"><a href="#cb271-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkolivegreen4"</span>, <span class="st">"darkslategray"</span>)) <span class="sc">+</span></span>
<span id="cb271-126"><a href="#cb271-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="fu">paste</span>(sample_name, <span class="st">" - Distribution of CP homologues"</span>)) <span class="sc">+</span></span>
<span id="cb271-127"><a href="#cb271-127" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb271-128"><a href="#cb271-128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Relative `Normalized Area` distribution, %"</span>) <span class="sc">+</span></span>
<span id="cb271-129"><a href="#cb271-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb271-130"><a href="#cb271-130" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb271-131"><a href="#cb271-131" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.15</span>, <span class="st">"in"</span>),</span>
<span id="cb271-132"><a href="#cb271-132" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb271-133"><a href="#cb271-133" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb271-134"><a href="#cb271-134" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb271-135"><a href="#cb271-135" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">colour =</span> <span class="st">"grey20"</span>),</span>
<span id="cb271-136"><a href="#cb271-136" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey50"</span>),</span>
<span id="cb271-137"><a href="#cb271-137" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor.y =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey80"</span>),</span>
<span id="cb271-138"><a href="#cb271-138" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb271-139"><a href="#cb271-139" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb271-140"><a href="#cb271-140" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey20"</span>),</span>
<span id="cb271-141"><a href="#cb271-141" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb271-142"><a href="#cb271-142" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb271-143"><a href="#cb271-143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(. <span class="sc">~</span> Chain_length, <span class="at">scales =</span> <span class="st">"free"</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb271-144"><a href="#cb271-144" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-145"><a href="#cb271-145" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the plot for the current sample in the list</span></span>
<span id="cb271-146"><a href="#cb271-146" aria-hidden="true" tabindex="-1"></a>  all_plots[[sample_name]] <span class="ot">&lt;-</span> plot</span>
<span id="cb271-147"><a href="#cb271-147" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-148"><a href="#cb271-148" aria-hidden="true" tabindex="-1"></a>  results_output_MCCPs <span class="ot">&lt;-</span> results <span class="sc">|&gt;</span> </span>
<span id="cb271-149"><a href="#cb271-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">median</span>(Concentration)) <span class="sc">|&gt;</span> </span>
<span id="cb271-150"><a href="#cb271-150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb271-151"><a href="#cb271-151" aria-hidden="true" tabindex="-1"></a>      <span class="at">Type =</span> results<span class="sc">$</span>Type[<span class="dv">1</span>],</span>
<span id="cb271-152"><a href="#cb271-152" aria-hidden="true" tabindex="-1"></a>      <span class="at">Sample =</span> sample_name,</span>
<span id="cb271-153"><a href="#cb271-153" aria-hidden="true" tabindex="-1"></a>      <span class="at">Comment =</span> <span class="fu">paste</span>(<span class="st">"The best match:"</span>, results<span class="sc">$</span>Fraction_Comp_1[<span class="dv">1</span>], <span class="st">"% of "</span>, results<span class="sc">$</span>Comp_1[<span class="dv">1</span>], <span class="st">" and "</span>, <span class="dv">100</span> <span class="sc">-</span> results<span class="sc">$</span>Fraction_Comp_1[<span class="dv">1</span>], <span class="st">"% of "</span>, results<span class="sc">$</span>Comp_2[<span class="dv">1</span>])</span>
<span id="cb271-154"><a href="#cb271-154" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb271-155"><a href="#cb271-155" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="st">"Total concentration, ng/µL"</span> <span class="ot">=</span> <span class="st">"median(Concentration)"</span>)</span>
<span id="cb271-156"><a href="#cb271-156" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-157"><a href="#cb271-157" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine results for all samples into a single dataframe</span></span>
<span id="cb271-158"><a href="#cb271-158" aria-hidden="true" tabindex="-1"></a>  all_results_df_MCCPs <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(all_results, <span class="at">.id =</span> <span class="st">"Sample"</span>)</span>
<span id="cb271-159"><a href="#cb271-159" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-160"><a href="#cb271-160" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print or further process the combined results dataframe</span></span>
<span id="cb271-161"><a href="#cb271-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(all_results_df_MCCPs)</span>
<span id="cb271-162"><a href="#cb271-162" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Print results output</span></span>
<span id="cb271-163"><a href="#cb271-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(results_output_MCCPs)</span>
<span id="cb271-164"><a href="#cb271-164" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb271-165"><a href="#cb271-165" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing sample: NIST_R1"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `Type = results$Type[1]`.
Caused by warning:
! Unknown or uninitialised column: `Type`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 33
   Sample  `Replicate Name` `Sample Type` Homologue  `Molecule Formula`
   &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;         &lt;chr&gt;      &lt;lgl&gt;             
 1 NIST_R1 NIST_R1          Unknown       C14H27Cl3  NA                
 2 NIST_R1 NIST_R1          Unknown       C14H26Cl4  NA                
 3 NIST_R1 NIST_R1          Unknown       C14H25Cl5  NA                
 4 NIST_R1 NIST_R1          Unknown       C14H24Cl6  NA                
 5 NIST_R1 NIST_R1          Unknown       C14H23Cl7  NA                
 6 NIST_R1 NIST_R1          Unknown       C14H22Cl8  NA                
 7 NIST_R1 NIST_R1          Unknown       C14H21Cl9  NA                
 8 NIST_R1 NIST_R1          Unknown       C14H20Cl10 NA                
 9 NIST_R1 NIST_R1          Unknown       C14H19Cl11 NA                
10 NIST_R1 NIST_R1          Unknown       C14H18Cl12 NA                
# ℹ 30 more rows
# ℹ 28 more variables: `Precursor Mz` &lt;dbl&gt;, Quantitative &lt;lgl&gt;,
#   `Isotope Label Type` &lt;chr&gt;, `Explicit Retention Time` &lt;dbl&gt;,
#   `Explicit Retention Time Window` &lt;dbl&gt;, `Molecule List` &lt;chr&gt;,
#   `Product Adduct` &lt;chr&gt;, `Precursor Adduct` &lt;chr&gt;, Area &lt;dbl&gt;,
#   `Normalized Area` &lt;dbl&gt;, `Normalization Method` &lt;chr&gt;,
#   `Limit Of Detection` &lt;lgl&gt;, `Analyte Concentration` &lt;dbl&gt;, …
# A tibble: 1 × 3
  `Total concentration, ng/µL` Sample  Comment                                  
                         &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;                                    
1                        0.639 NIST_R1 The best match: 1 % of  A- MCCPs  and  9…
[1] "Processing sample: NIST_R2"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `Type = results$Type[1]`.
Caused by warning:
! Unknown or uninitialised column: `Type`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 33
   Sample  `Replicate Name` `Sample Type` Homologue  `Molecule Formula`
   &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;         &lt;chr&gt;      &lt;lgl&gt;             
 1 NIST_R1 NIST_R1          Unknown       C14H27Cl3  NA                
 2 NIST_R1 NIST_R1          Unknown       C14H26Cl4  NA                
 3 NIST_R1 NIST_R1          Unknown       C14H25Cl5  NA                
 4 NIST_R1 NIST_R1          Unknown       C14H24Cl6  NA                
 5 NIST_R1 NIST_R1          Unknown       C14H23Cl7  NA                
 6 NIST_R1 NIST_R1          Unknown       C14H22Cl8  NA                
 7 NIST_R1 NIST_R1          Unknown       C14H21Cl9  NA                
 8 NIST_R1 NIST_R1          Unknown       C14H20Cl10 NA                
 9 NIST_R1 NIST_R1          Unknown       C14H19Cl11 NA                
10 NIST_R1 NIST_R1          Unknown       C14H18Cl12 NA                
# ℹ 70 more rows
# ℹ 28 more variables: `Precursor Mz` &lt;dbl&gt;, Quantitative &lt;lgl&gt;,
#   `Isotope Label Type` &lt;chr&gt;, `Explicit Retention Time` &lt;dbl&gt;,
#   `Explicit Retention Time Window` &lt;dbl&gt;, `Molecule List` &lt;chr&gt;,
#   `Product Adduct` &lt;chr&gt;, `Precursor Adduct` &lt;chr&gt;, Area &lt;dbl&gt;,
#   `Normalized Area` &lt;dbl&gt;, `Normalization Method` &lt;chr&gt;,
#   `Limit Of Detection` &lt;lgl&gt;, `Analyte Concentration` &lt;dbl&gt;, …
# A tibble: 1 × 3
  `Total concentration, ng/µL` Sample  Comment                                  
                         &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;                                    
1                        0.649 NIST_R2 The best match: 1 % of  A- MCCPs  and  9…
[1] "Processing sample: NIST_R3"</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_1st[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in results$RF_2nd[i] &lt;- input$Sum_response_factor[input$STD_code == :
number of items to replace is not a multiple of replacement length</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `Type = results$Type[1]`.
Caused by warning:
! Unknown or uninitialised column: `Type`.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 120 × 33
   Sample  `Replicate Name` `Sample Type` Homologue  `Molecule Formula`
   &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;         &lt;chr&gt;      &lt;lgl&gt;             
 1 NIST_R1 NIST_R1          Unknown       C14H27Cl3  NA                
 2 NIST_R1 NIST_R1          Unknown       C14H26Cl4  NA                
 3 NIST_R1 NIST_R1          Unknown       C14H25Cl5  NA                
 4 NIST_R1 NIST_R1          Unknown       C14H24Cl6  NA                
 5 NIST_R1 NIST_R1          Unknown       C14H23Cl7  NA                
 6 NIST_R1 NIST_R1          Unknown       C14H22Cl8  NA                
 7 NIST_R1 NIST_R1          Unknown       C14H21Cl9  NA                
 8 NIST_R1 NIST_R1          Unknown       C14H20Cl10 NA                
 9 NIST_R1 NIST_R1          Unknown       C14H19Cl11 NA                
10 NIST_R1 NIST_R1          Unknown       C14H18Cl12 NA                
# ℹ 110 more rows
# ℹ 28 more variables: `Precursor Mz` &lt;dbl&gt;, Quantitative &lt;lgl&gt;,
#   `Isotope Label Type` &lt;chr&gt;, `Explicit Retention Time` &lt;dbl&gt;,
#   `Explicit Retention Time Window` &lt;dbl&gt;, `Molecule List` &lt;chr&gt;,
#   `Product Adduct` &lt;chr&gt;, `Precursor Adduct` &lt;chr&gt;, Area &lt;dbl&gt;,
#   `Normalized Area` &lt;dbl&gt;, `Normalization Method` &lt;chr&gt;,
#   `Limit Of Detection` &lt;lgl&gt;, `Analyte Concentration` &lt;dbl&gt;, …
# A tibble: 1 × 3
  `Total concentration, ng/µL` Sample  Comment                                  
                         &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;                                    
1                         2.34 NIST_R3 The best match: 1 % of  A- MCCPs  and  9…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb519"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################VIEW RESULTS############################################</span></span>
<span id="cb519-2"><a href="#cb519-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-3"><a href="#cb519-3" aria-hidden="true" tabindex="-1"></a><span class="co">#View Overview</span></span>
<span id="cb519-4"><a href="#cb519-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(all_results_df_MCCPs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 120 × 33
   Sample  `Replicate Name` `Sample Type` Homologue  `Molecule Formula`
   &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;         &lt;chr&gt;      &lt;lgl&gt;             
 1 NIST_R1 NIST_R1          Unknown       C14H27Cl3  NA                
 2 NIST_R1 NIST_R1          Unknown       C14H26Cl4  NA                
 3 NIST_R1 NIST_R1          Unknown       C14H25Cl5  NA                
 4 NIST_R1 NIST_R1          Unknown       C14H24Cl6  NA                
 5 NIST_R1 NIST_R1          Unknown       C14H23Cl7  NA                
 6 NIST_R1 NIST_R1          Unknown       C14H22Cl8  NA                
 7 NIST_R1 NIST_R1          Unknown       C14H21Cl9  NA                
 8 NIST_R1 NIST_R1          Unknown       C14H20Cl10 NA                
 9 NIST_R1 NIST_R1          Unknown       C14H19Cl11 NA                
10 NIST_R1 NIST_R1          Unknown       C14H18Cl12 NA                
# ℹ 110 more rows
# ℹ 28 more variables: `Precursor Mz` &lt;dbl&gt;, Quantitative &lt;lgl&gt;,
#   `Isotope Label Type` &lt;chr&gt;, `Explicit Retention Time` &lt;dbl&gt;,
#   `Explicit Retention Time Window` &lt;dbl&gt;, `Molecule List` &lt;chr&gt;,
#   `Product Adduct` &lt;chr&gt;, `Precursor Adduct` &lt;chr&gt;, Area &lt;dbl&gt;,
#   `Normalized Area` &lt;dbl&gt;, `Normalization Method` &lt;chr&gt;,
#   `Limit Of Detection` &lt;lgl&gt;, `Analyte Concentration` &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb521"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true" tabindex="-1"></a><span class="co">#View graph, REPLACE THE NAME OF THE SAMPLE YOU WANT TO SEE, another option is to open the list from the Environment and from there open each plot</span></span>
<span id="cb521-2"><a href="#cb521-2" aria-hidden="true" tabindex="-1"></a>all_plots[[<span class="st">"NIST_R1"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-1-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb522"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a>all_plots[[<span class="st">"NIST_R2"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-1-10.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb523"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a>all_plots[[<span class="st">"NIST_R3"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="FinalProject_files/figure-html/unnamed-chunk-1-11.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb524"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################################################</span></span>
<span id="cb524-2"><a href="#cb524-2" aria-hidden="true" tabindex="-1"></a><span class="do">############################################### RESULTS #####################################################</span></span>
<span id="cb524-3"><a href="#cb524-3" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################################################</span></span>
<span id="cb524-4"><a href="#cb524-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb524-5"><a href="#cb524-5" aria-hidden="true" tabindex="-1"></a><span class="do">########################### COMBINE SCCPs AND MCCPs ######################################################################</span></span>
<span id="cb524-6"><a href="#cb524-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb524-7"><a href="#cb524-7" aria-hidden="true" tabindex="-1"></a>combined_RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(all_results_df_SCCPs, all_results_df_MCCPs) <span class="sc">|&gt;</span> </span>
<span id="cb524-8"><a href="#cb524-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Homologue_Concentration =</span> Relative_distribution <span class="sc">*</span> Concentration)</span>
<span id="cb524-9"><a href="#cb524-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb524-10"><a href="#cb524-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb524-11"><a href="#cb524-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb524-12"><a href="#cb524-12" aria-hidden="true" tabindex="-1"></a><span class="do">############################SAVE RESULTS####</span></span>
<span id="cb524-13"><a href="#cb524-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Set save directory (where do we want to save)</span></span>
<span id="cb524-14"><a href="#cb524-14" aria-hidden="true" tabindex="-1"></a>save.directory <span class="ot">&lt;-</span> <span class="st">"F:/LINKOPING/Manuscripts/Skyline/Skyline/"</span></span>
<span id="cb524-15"><a href="#cb524-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb524-16"><a href="#cb524-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Save results in excel txt</span></span>
<span id="cb524-17"><a href="#cb524-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(combined_RESULTS, <span class="fu">paste</span>(save.directory,<span class="st">"PCA_Qauntification_Results"</span>, <span class="st">".txt"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>) </span>
<span id="cb524-18"><a href="#cb524-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb524-19"><a href="#cb524-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Save results in excel format</span></span>
<span id="cb524-20"><a href="#cb524-20" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(combined_RESULTS, <span class="fu">paste</span>(save.directory,<span class="st">"PCA_Qauntification_Results"</span>, <span class="st">".xlsx"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>) </span>
<span id="cb524-21"><a href="#cb524-21" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(combined_RESULTS, <span class="fu">paste</span>(save.directory,<span class="st">"PCA_Qauntification_Results"</span>, <span class="st">".csv"</span>, <span class="at">sep =</span> <span class="st">""</span>), <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Chapter6.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exercise 1: Data plotting and transformations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./summary.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Summary</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>